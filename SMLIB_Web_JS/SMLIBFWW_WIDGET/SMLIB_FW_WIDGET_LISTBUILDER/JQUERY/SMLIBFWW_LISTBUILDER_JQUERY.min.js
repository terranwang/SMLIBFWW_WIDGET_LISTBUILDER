(function(n){n.fn.smlib_listbuilder_builder=function(){return{userid:"",mylist:[],sharelist:[],collaboratelist:[],msg:""}};n.fn.smlib_listbuilder_list=function(){return{id:"",name:"",desc:"",creator:"",creation:"",creatorname:"",type:"",itemcount:0,item:[],shared:[],msg:""}};n.fn.smlib_listbuilder_item=function(){return{id:"",listid:"",title:"",desc:"",index:0,type:"",refid:"",url:"",creator:"",creation:"",creatorname:"",itemcover:"",itemcoverbase64:"",itemlogo:"",msg:""}};n.fn.smlib_listbuilder_option=function(){return{position:"relative",width:1e3,height:800,top:20,left:20,additional_css:"",loadingimg:"",bgfile:"",maxsearchresult:10,webroot:"",widgetroot:"",titleroot:"",patronroot:"",loginuserid:"",autoadd:!1,showlistbtn:!0,showaddbtn:!0,showcataloguebtn:!0,showfilebtn:!0,showyoutubebtn:!0,showurlbtn:!0,showprintbtn:!0,showexportbtn:!0,showsearchuserbtn:!1,loadbuilderservice:"",savelistservice:"",deletelistservice:"",saveitemservice:"",deleteitemservice:"",reorderitemservice:"",savesharedemailservice:"",deletesharedemailservice:"",youtubesearchservice:"",youtubesearchkey:"",booksearchservice:"",patronsearchservice:"",filesearchservice:"",getitemdetailservice:"",emailsharedemailservice:"",sharetypechangeservice:"",pdfsizewidth:210,pdfsizeheight:297,pdfmarginleft:5,pdfmarginright:5,pdfmargintop:7,pdfmarginbottom:2,pdfitemperpage:10,pdfitemmargin:5,pdffont:"times",pdffonttype:"normal",pdffontsize:12,pdffontwidthrate:2.834646,pdffontheightrate:2.834646*2,pdftablewidth:0,pdftableheight:0,pdfheaderwidth:0,pdfheaderheight:0,pdfcataloguetokenwidth:0,pdfcataloguetokenheight:0,pdfurltokenwidth:0,pdfurltokenheight:0,catalogueprinttokens:[{key:"NOT_SET",value:"Please Choose a Field..."},{key:"ADD_PATRON",value:"Add To List By"},{key:"ADD_DATE",value:"Add To List Date"},{key:"AUTHOR",value:"Author"},{key:"CATALOGUER",value:"Catalogue By"},{key:"CATALOGUE_DATE",value:"Catalogue Date"},{key:"COVER",value:"Cover"},{key:"DESCRIPTION",value:"Description"},{key:"ISBN",value:"ISBN"},{key:"PUBLISHER",value:"Publisher"},{key:"PUBLISHER_WITH_PLACE",value:"Publisher / Place"},{key:"PUBLISHER_DATE",value:"Publisher Date"},{key:"PUBLISHER_PLACE",value:"Publisher Place"},{key:"SERIES",value:"Series"},{key:"TITLE",value:"Title"},{key:"URL",value:"URL"}],urlprinttokens:[{key:"NOT_SET",value:"Please Choose a Field..."},{key:"ADD_PATRON",value:"Add To List By"},{key:"ADD_DATE",value:"Add To List Date"},{key:"COVER",value:"Cover"},{key:"DESCRIPTION",value:"Description"},{key:"TITLE",value:"Title"},{key:"URL",value:"URL"}]}}})(jQuery),function(n){n.fn.smlib_listbuilder_create=function(t){this.smlib_listbuilder_create_options=n.extend({},n.fn.smlib_listbuilder_option(),t);this.smlibid=n(this).attr("id");var i=n.fn.smlib_listbuilder_create.smlib_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options);return n(this).html(i),this.maindiv=n("#"+this.smlibid+"_maindiv"),this.maindiv.smlibid=this.smlibid,this.maindiv.parent=this,this.maindiv.smlib_listbuilder_create_options=this.smlib_listbuilder_create_options,n.fn.smlib_listbuilder_create.smlib_AssignFunctions(this.maindiv),this.maindiv};n.fn.smlib_listbuilder_create.smlib_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_maindiv" ',r+='class="smlib_listbuilder_create_maindiv '+i.additional_css+'" ',r+='style="',i.bgfile!=""&&(r+="background: url('"+i.bgfile+"') TRANSPARENT;"),r+="position:"+i.position+";width:"+i.width+"px;min-height:"+i.height+'px;" ',r+=">",r+=n.fn.smlib_listbuilder_create.smlib_Input_InnerHTML(t,i),r+=n.fn.smlib_listbuilder_create.smlib_Content_InnerHTML(t,i),r+="<\/div>",r+='<div id="'+t+'_hiddenbutton" class="btn btn-danger" style="display:none">HiddenBtn<\/div>',r+="<div ",r+='style="width:'+i.width+"px;height:"+i.height+'px;" ',r+='class="mask" ',r+=">",r+="<\/div>",r+="<div ",r+='id="'+t+'_loadingmask" ',r+='class="smlib_listbuilder_create_loadingmask"',r+='style="width:'+i.width+"px;height:"+i.height+'px;"',r+=">",r+='<div class="loadingimg" style="width:'+i.width+"px;max-width:"+i.width+"px;min-width:"+i.width+'px; font-size:30px;display:block;text-align:center"><i class="fa fa-spinner fa-spin" style="color:inherit;" ><\/i><div id="'+t+'_loadingmessage" style="display:block;font-size:30px;color:inherit;">Loading...<\/div><\/div>',r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_AssignFunctions=function(t){t.smlib_AssignParentActions=n.fn.smlib_listbuilder_create.smlib_AssignParentActions;t.smlibShowLoadingMask=n.fn.smlib_listbuilder_create.smlibShowLoadingMask;t.smlibHideLoadingMask=n.fn.smlib_listbuilder_create.smlibHideLoadingMask;t.smlibInsertAtCaret=n.fn.smlib_listbuilder_create.smlibInsertAtCaret;t.smlibLoadBuilder=n.fn.smlib_listbuilder_create.smlibLoadBuilder;t.smlibLoadBuilderResult=n.fn.smlib_listbuilder_create.smlibLoadBuilderResult;t.actleft=n("#"+t.smlibid+"_maindiv").offset().left;t.acttop=n("#"+t.smlibid+"_maindiv").offset().top;n.fn.smlib_listbuilder_create.smlib_AssignControls(t);n.fn.smlib_listbuilder_create.smlib_Input_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_Content_AssignFunctions(t)};n.fn.smlib_listbuilder_create.smlib_AssignControls=function(t){t.focusbuilder=new n.fn.smlib_listbuilder_builder;t.focuslist=new n.fn.smlib_listbuilder_list;t.focusitem=new n.fn.smlib_listbuilder_item;t.focuslistid="";n('[data-toggle="tooltip"]').tooltip();n('[data-toggle="popover"]').popover();var i=null;i=document.getElementById(t.smlibid+"_hiddenbutton");i!=null&&(i.parent=t)};n.fn.smlib_listbuilder_create.smlib_AssignParentActions=function(n,t){return t!=null?"document.getElementById('"+t+"_hiddenbutton').parent."+n:"document.getElementById('"+this.smlibid+"_hiddenbutton').parent."+n};n.fn.smlib_listbuilder_create.smlibShowLoadingMask=function(t){t==null&&(t="Loading...");n("#"+this.smlibid+"_loadingmessage").html(t);n("#"+this.smlibid+"_loadingmask").hasClass("smlibactive")||n("#"+this.smlibid+"_loadingmask").addClass("smlibactive")};n.fn.smlib_listbuilder_create.smlibHideLoadingMask=function(){n("#"+this.smlibid+"_loadingmask").hasClass("smlibactive")&&(n("#"+this.smlibid+"_loadingmask").removeClass("smlibactive"),n("#"+this.smlibid+"_loadingmessage").val(""))};n.fn.smlib_listbuilder_create.smlibInsertAtCaret=function(n,t){document.selection&&n.tagName=="TEXTAREA"?(n.focus(),sel=document.selection.createRange(),sel.text=t,n.focus()):n.selectionStart||n.selectionStart=="0"?(startPos=n.selectionStart,endPos=n.selectionEnd,scrollTop=n.scrollTop,n.value=n.value.substring(0,startPos)+t+n.value.substring(endPos,n.value.length),n.focus(),n.selectionStart=startPos+t.length,n.selectionEnd=startPos+t.length,n.scrollTop=scrollTop):(n.value+=t,n.focus(),n.value=n.value)};n.fn.smlib_listbuilder_create.smlibLoadBuilder=function(){this.smlibShowLoadingMask("Load All Lists...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.loadbuilderservice,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){try{this.parent.smlibLoadBuilderResult(JSON.parse(n.d))}catch(t){alert("Load Lists Fail "+t)}},failure:function(n){alert("Load Lists Fail "+n)}})};n.fn.smlib_listbuilder_create.smlibLoadBuilderResult=function(n){var r,t,i;n.msg!=""?alert(n.msg):(this.focusbuilder=n,this.smlib_Content_ShowContent(),this.smlib_Content_LoadContent(),r=new RegExp("(^|&)ListID=([^&]*)(&|$)"),t=window.location.search.substr(1).match(r),this.focuslistid="",t!=null&&(this.focuslistid=unescape(t[2])),this.focuslistid!=""&&(i=this.smlib_BuilderList_GetListByID(this.focuslistid),i!=null?(this.focuslist=i,this.smlib_Content_LoadContent("ITEM_LIST")):alert("List is not found or no enough permission.")));this.smlibHideLoadingMask()}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_Input_InnerHTML=function(n){var t="";return t+="<div ",t+='id="'+n+'_inputdiv" ',t+='class="smlib_listbuilder_create_inputdiv" ',t+=">",t+='<div id="'+n+'_inputdivcontent" style="width:100%;">',t+="<\/div>",t+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_Input_AssignFunctions=function(t){n.fn.smlib_listbuilder_create.smlib_Input_AssignControls(t);t.smlib_Input_ShowListClick=n.fn.smlib_listbuilder_create.smlib_Input_ShowListClick;t.smlib_Input_AddListClick=n.fn.smlib_listbuilder_create.smlib_Input_AddListClick;t.smlib_Input_AddCatalogueClick=n.fn.smlib_listbuilder_create.smlib_Input_AddCatalogueClick;t.smlib_Input_AddFileClick=n.fn.smlib_listbuilder_create.smlib_Input_AddFileClick;t.smlib_Input_AddYouTubeClick=n.fn.smlib_listbuilder_create.smlib_Input_AddYouTubeClick;t.smlib_Input_AddUrlClick=n.fn.smlib_listbuilder_create.smlib_Input_AddUrlClick;t.smlib_Input_PrintClick=n.fn.smlib_listbuilder_create.smlib_Input_PrintClick;t.smlib_Input_ShareClick=n.fn.smlib_listbuilder_create.smlib_Input_ShareClick;t.smlib_Input_ShowListMode=n.fn.smlib_listbuilder_create.smlib_Input_ShowListMode;t.smlib_Input_ShowContentMode=n.fn.smlib_listbuilder_create.smlib_Input_ShowContentMode;t.smlib_Input_ShowListMode()};n.fn.smlib_listbuilder_create.smlib_Input_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_Input_ShowListMode=function(){var t="";this.smlib_listbuilder_create_options.showaddbtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_addbtn" class="fa fa-plus fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_AddListClick()")+'">&nbsp;New List<\/i><\/span>');n("#"+this.smlibid+"_inputdivcontent").html(t)};n.fn.smlib_listbuilder_create.smlib_Input_ShowContentMode=function(){var t="";this.smlib_listbuilder_create_options.showlistbtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_listbtn" class="fa fa-list fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_ShowListClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showcataloguebtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_cataloguebtn" class="fa fa-book fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_AddCatalogueClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showfilebtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_filebtn" class="fa fa-file fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_AddFileClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showyoutubebtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_youtubebtn" class="fa fa-youtube fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_AddYouTubeClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showurlbtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;" ><i id="'+this.smlibid+'_create_urlbtn" class="fa fa-link fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_AddUrlClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showexportbtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;float:right;" ><i id="'+this.smlibid+'_create_exportbtn" class="fa fa-share-alt fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_ShareClick()")+'"><\/i><\/span>');this.smlib_listbuilder_create_options.showprintbtn&&(t+='<span  role="button" style="width:20px;margin-right:10px;font-size:20px;float:right;" ><i id="'+this.smlibid+'_create_printbtn" class="fa fa-file-pdf-o fa-fw" style="width:auto;" onclick="'+this.smlib_AssignParentActions("smlib_Input_PrintClick()")+'"><\/i><\/span>');n("#"+this.smlibid+"_inputdivcontent").html(t)};n.fn.smlib_listbuilder_create.smlib_Input_ShowListClick=function(){this.smlib_Content_LoadContent("BUILDER_LIST");this.smlib_Input_ShowListMode()};n.fn.smlib_listbuilder_create.smlib_Input_AddListClick=function(){this.smlib_Content_LoadContent("ADD_LIST");this.smlib_Input_ShowContentMode()};n.fn.smlib_listbuilder_create.smlib_Input_AddCatalogueClick=function(){this.smlib_Content_LoadContent("CATALOGUE_FORM")};n.fn.smlib_listbuilder_create.smlib_Input_AddFileClick=function(){this.smlib_Content_LoadContent("FILE_FORM")};n.fn.smlib_listbuilder_create.smlib_Input_AddYouTubeClick=function(){this.smlib_Content_LoadContent("YOUTUBE_FORM")};n.fn.smlib_listbuilder_create.smlib_Input_AddUrlClick=function(){this.smlib_Content_LoadContent("URL_FORM")};n.fn.smlib_listbuilder_create.smlib_Input_PrintClick=function(){this.smlib_Content_LoadContent("PRINT_FORM")};n.fn.smlib_listbuilder_create.smlib_Input_ShareClick=function(){this.smlib_Content_LoadContent("SHARE_FROM")}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_BuilderList_InnerHTML=function(n,t){var i="";return i+="<div ",i+='id="'+n+'_builderlist_headerdiv" ',i+='class="header info"',i+=">",i+="<\/div>",i+="<div ",i+='id="'+n+'_builderlist_contentdiv" ',i+='class="content info" style="height:'+(t.height-80)+"px;min-height:"+(t.height-80)+"px;max-height:"+(t.height-80)+'px"',i+=">",i+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_BuilderList_AssignFunctions=function(t){n.fn.smlib_listbuilder_create.smlib_BuilderList_AssignControls(t);t.smlib_BuilderList_GetListByID=n.fn.smlib_listbuilder_create.smlib_BuilderList_GetListByID;t.smlib_BuilderList_RemoveListByID=n.fn.smlib_listbuilder_create.smlib_BuilderList_RemoveListByID;t.smlib_BuilderList_Load=n.fn.smlib_listbuilder_create.smlib_BuilderList_Load;t.smlib_BuilderList_ListItemDiv=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDiv;t.smlib_BuilderList_ListItemClick=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemClick;t.smlib_BuilderList_ListItemEditClick=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemEditClick;t.smlib_BuilderList_ListItemDeleteClick=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteClick;t.smlib_BuilderList_ListItemDeleteService=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteService;t.smlib_BuilderList_ListItemDeleteServiceResult=n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteServiceResult};n.fn.smlib_listbuilder_create.smlib_BuilderList_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_BuilderList_GetListByID=function(n,t){for(var r=this.focusbuilder,i=0;i<r.mylist.length;i++)if(r.mylist[i].id==n)return t!=null&&(r.mylist[i]=t),r.mylist[i];for(i=0;i<r.sharelist.length;i++)if(r.sharelist[i].id==n)return t!=null&&(r.sharelist[i]=t),r.sharelist[i];for(i=0;i<r.collaboratelist.length;i++)if(r.collaboratelist[i].id==n)return t!=null&&(r.collaboratelist[i]=t),r.collaboratelist[i];return null};n.fn.smlib_listbuilder_create.smlib_BuilderList_RemoveListByID=function(n){var i=this.focusbuilder,r=i.mylist,t;for(i.mylist=[],t=0;t<r.length;t++)r[t].id==n||(i.mylist[i.mylist.length]=r[t]);for(r=i.sharelist,i.sharelist=[],t=0;t<r.length;t++)r[t].id==n||(i.sharelist[i.sharelist.length]=r[t]);for(r=i.collaboratelist,i.collaboratelist=[],t=0;t<r.length;t++)r[t].id==n||(i.collaboratelist[i.collaboratelist.length]=r[t]);this.focusbuilder=i};n.fn.smlib_listbuilder_create.smlib_BuilderList_Load=function(t){var i;for(t==null?t=this.focusbuilder:this.focusbuilder=t,n("#"+this.smlibid+"_builderlist_contentdiv").html(""),i=0;i<t.mylist.length;i++)n("#"+this.smlibid+"_builderlist_contentdiv").append(this.smlib_BuilderList_ListItemDiv(t.mylist[i]));for(i=0;i<t.sharelist.length;i++)n("#"+this.smlibid+"_builderlist_contentdiv").append(this.smlib_BuilderList_ListItemDiv(t.sharelist[i]));for(i=0;i<t.collaboratelist.length;i++)n("#"+this.smlibid+"_builderlist_contentdiv").append(this.smlib_BuilderList_ListItemDiv(t.collaboratelist[i]))};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDiv=function(n){var t="";t+='<div class="itemdiv">';t+="<h5>";t+='<strong role="button" onclick="'+this.smlib_AssignParentActions("smlib_BuilderList_ListItemClick('"+n.id+"')")+'">'+n.name+"<\/strong>";t+='&nbsp;&nbsp;&nbsp;&nbsp;<i class="fa fa-pencil-square-o fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_BuilderList_ListItemEditClick('"+n.id+"')")+'"><\/i>&nbsp;&nbsp;<i class="fa fa-trash fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_BuilderList_ListItemDeleteClick('"+n.id+"')")+'"><\/i>';t+="<\/h5>";t+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;"+n.desc+"<\/h5>";t+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;By "+n.creator+" On "+n.creation+"<\/h5>";switch(n.type.toUpperCase()){case"MY_LIST":t+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;My List<\/h5>";break;case"SHARED_LIST":t+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;Static List<\/h5>";break;case"COLLABORATE_LIST":t+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;Collaborative List<\/h5>"}return t+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemClick=function(n){var t=this.smlib_BuilderList_GetListByID(n);t!=null&&(this.focuslist=t,this.smlib_Content_LoadContent("ITEM_LIST"));this.smlib_Input_ShowContentMode()};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemEditClick=function(n){var t=this.smlib_BuilderList_GetListByID(n);t!=null&&(this.focuslist=t,this.smlib_Content_LoadContent("EDIT_LIST"))};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteClick=function(n){var t=this.smlib_BuilderList_GetListByID(n);t!=null&&this.smlib_BuilderList_ListItemDeleteService(t)};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteService=function(t){t==null&&(t=this.focuslist);this.smlibShowLoadingMask("Delete List...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.deletelistservice,data:'{"id": "'+t.id+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_BuilderList_ListItemDeleteServiceResult(JSON.parse(n.d))}catch(t){alert("Save Lists Fail "+t)}},failure:function(n){alert("Save Lists Fail "+n)}})};n.fn.smlib_listbuilder_create.smlib_BuilderList_ListItemDeleteServiceResult=function(n){n.msg!=""?alert(n.msg):(this.smlib_BuilderList_RemoveListByID(n.id),this.smlib_Content_LoadContent("BUILDER_LIST"));this.smlibHideLoadingMask()}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_ListForm_InnerHTML=function(t,i,r){r==null&&(r="NEW");var u="";return u+="<div ",u+='id="'+t+'_listform_headerdiv" ',u+='class="header"',u+=">",u+='<div class="input-group inputdiv" style="width:100%;">',u+='<input type="textbox" class="form-control" placeholder="List Name" id="'+t+'_listform_namebox"/>',u+='<span class="input-group-addon" role="button"  >',r=="NEW"?u+='<i id="'+t+'_listform_addbtn" class="fa fa-plus fa-fw" style="width:auto;" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_ListForm_AddClick()",t)+'"><\/i>':r=="EDIT"&&(u+='<i id="'+t+'_listform_addbtn" class="fa fa-pencil fa-fw" style="width:auto;" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_ListForm_UpdateClick()",t)+'"><\/i>'),u+="<\/span>",u+="<\/div>",u+='<div class="input-group inputdiv" style="width:100%;">',u+='<textarea class="form-control" placeholder="Description" id="'+t+'_listform_descbox" rows="5"><\/textarea>',u+="<\/div>",u+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ListForm_AssignFunctions=function(t){t.smlib_ListForm_LoadList=n.fn.smlib_listbuilder_create.smlib_ListForm_LoadList;t.smlib_ListForm_LoadBlank=n.fn.smlib_listbuilder_create.smlib_ListForm_LoadBlank;t.smlib_ListForm_AddClick=n.fn.smlib_listbuilder_create.smlib_ListForm_AddClick;t.smlib_ListForm_UpdateClick=n.fn.smlib_listbuilder_create.smlib_ListForm_UpdateClick;t.smlib_ListForm_AddService=n.fn.smlib_listbuilder_create.smlib_ListForm_AddService;t.smlib_ListForm_AddServiceResult=n.fn.smlib_listbuilder_create.smlib_ListForm_AddServiceResult;n.fn.smlib_listbuilder_create.smlib_ListForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_ListForm_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_ListForm_LoadList=function(t){t==null&&(t=this.focuslist);n("#"+this.smlibid+"_listform_namebox").val(t.name);n("#"+this.smlibid+"_listform_descbox").val(t.desc)};n.fn.smlib_listbuilder_create.smlib_ListForm_LoadBlank=function(){n("#"+this.smlibid+"_listform_namebox").val("");n("#"+this.smlibid+"_listform_descbox").val("")};n.fn.smlib_listbuilder_create.smlib_ListForm_AddClick=function(){if(n("#"+this.smlibid+"_listform_namebox").val()!=""){var t=new n.fn.smlib_listbuilder_list;t.id="";t.name=n("#"+this.smlibid+"_listform_namebox").val();t.desc=n("#"+this.smlibid+"_listform_descbox").val();t.creator="";t.creation="";t.type="MY_LIST";t.itemcount=0;t.item=[];this.smlib_ListForm_AddService(t)}else alert("Please enter list name")};n.fn.smlib_listbuilder_create.smlib_ListForm_UpdateClick=function(){n("#"+this.smlibid+"_listform_namebox").val()!=""?(this.focuslist.name=n("#"+this.smlibid+"_listform_namebox").val(),this.focuslist.desc=n("#"+this.smlibid+"_listform_descbox").val(),this.focuslist.type="MY_LIST",this.smlib_ListForm_AddService(this.focuslist)):alert("Please enter list name")};n.fn.smlib_listbuilder_create.smlib_ListForm_AddService=function(t){t==null&&(t=this.focuslist);this.smlibShowLoadingMask("Add List...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.savelistservice,data:'{"id": "'+t.id+'", "name": "'+t.name+'", "desc": "'+t.desc+'", "type":"'+t.type+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_ListForm_AddServiceResult(JSON.parse(n.d))}catch(t){alert("Save Lists Fail "+t)}},failure:function(n){alert("Save Lists Fail "+n)}})};n.fn.smlib_listbuilder_create.smlib_ListForm_AddServiceResult=function(n){n.msg!=""?alert(n.msg):(this.focuslist=n,this.smlib_BuilderList_GetListByID(n.id,n)==null&&(this.focusbuilder.mylist[this.focusbuilder.mylist.length]=n),this.smlib_Content_LoadContent("ITEM_LIST"));this.smlibHideLoadingMask()}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_ItemList_InnerHTML=function(n,t){var i="";return i+="<div ",i+='id="'+n+'_itemlist_headerdiv" ',i+='class="header"',i+=">",i+="<h5>List<\/h5>",i+="<\/div>",i+="<div ",i+='id="'+n+'_itemlist_contentdiv" ',i+='class="content" style="height:'+(t.height-100)+"px;min-height:"+(t.height-100)+"px;max-height:"+(t.height-100)+'px"',i+=">",i+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ItemList_AssignFunctions=function(t){n.fn.smlib_listbuilder_create.smlib_ItemList_AssignControls(t);t.smlib_ItemList_Load=n.fn.smlib_listbuilder_create.smlib_ItemList_Load;t.smlib_ItemList_ListItemDiv=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDiv;t.smlib_ItemList_HeaderClick=n.fn.smlib_listbuilder_create.smlib_ItemList_HeaderClick;t.smlib_ItemList_ListItemClick=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemClick;t.smlib_ItemList_ListItemEditClick=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemEditClick;t.smlib_ItemList_ListItemDeleteClick=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteClick;t.smlib_ItemList_AutoAddChange=n.fn.smlib_listbuilder_create.smlib_ItemList_AutoAddChange;t.smlib_ItemList_ReorderItems=n.fn.smlib_listbuilder_create.smlib_ItemList_ReorderItems;t.smlib_ItemList_ListItemSaveService=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemSaveService;t.smlib_ItemList_ListItemSaveServiceResult=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemSaveServiceResult;t.smlib_ItemList_ListItemDeleteService=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteService;t.smlib_ItemList_ListItemDeleteServiceResult=n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteServiceResult;t.smlib_ItemList_ReorderItemService=n.fn.smlib_listbuilder_create.smlib_ItemList_ReorderItemService;t.smlib_ItemList_GetItemByID=n.fn.smlib_listbuilder_create.smlib_ItemList_GetItemByID;t.smlib_ItemList_MapItemType=n.fn.smlib_listbuilder_create.smlib_ItemList_MapItemType;t.smlib_ItemList_MapItemLogo=n.fn.smlib_listbuilder_create.smlib_ItemList_MapItemLogo};n.fn.smlib_listbuilder_create.smlib_ItemList_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_ItemList_GetItemByID=function(n,t){for(var i=0;i<this.focuslist.item.length;i++)if(this.focuslist.item[i].id==n)return t!=null&&(this.focuslist.item[i]=t),this.focuslist.item[i];return null};n.fn.smlib_listbuilder_create.smlib_ItemList_MapItemLogo=function(n){var t="";if(n.url.toLowerCase().indexOf("worldlii.org")>0?t="WORLDLII":n.url.toLowerCase().indexOf("austlii.edu.au")>0?t="AUSTLII":n.url.toLowerCase().indexOf("ebscohost.com")>0?t="EBSCO":n.url.toLowerCase().indexOf("google.com")>0?t="GOOGLE":n.url.toLowerCase().indexOf("gutenberg.org")>0?t="GUTENBERG":n.url.toLowerCase().indexOf("worldbookonline.com")>0?t="WORLDBOOK":n.url.toLowerCase().indexOf("school.eb.com.au")>0?t="BRITANNICA":n.url.toLowerCase().indexOf("proquest.com")>0?t="PROQUEST":n.url.toLowerCase().indexOf("tv4education.com")>0?t="TV4EDUCATION":n.url.toLowerCase().indexOf("youtube.com")>0&&(t="YOUTUBE"),t==""&&(t.toLowerCase().indexOf("worldlii")>0?t="WORLDLII":t.toLowerCase().indexOf("austlii")>0?t="AUSTLII":t.toLowerCase().indexOf("ebsco")>0?t="EBSCO":t.toLowerCase().indexOf("google")>0?t="GOOGLE":t.toLowerCase().indexOf("gutenberg")>0?t="GUTENBERG":t.toLowerCase().indexOf("worldbook")>0?t="WORLDBOOK":t.toLowerCase().indexOf("britannica")>0?t="BRITANNICA":t.toLowerCase().indexOf("proquest")>0?t="PROQUEST":t.toLowerCase().indexOf("tv4education")>0?t="TV4EDUCATION":t.toLowerCase().indexOf("youtube.com")>0&&(t="YOUTUBE")),t=="")switch(n.type.toUpperCase()){case"CATALOGUE":t="CATALOGUE";break;case"FILE":t="FILE";break;case"YOUTUBE":t="YOUTUBE";break;case"URL":t="URL"}n.itemlogo=t;switch(t){case"WORLDLII":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;WORLDLII<\/h5>";case"AUSTLII":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;AUSTLII<\/h5>";case"EBSCO":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;EBSCO<\/h5>";case"GOOGLE":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;GOOGLE<\/h5>";case"GUTENBERG":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;GUTENBERG<\/h5>";case"WORLDBOOK":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;WORLDBOOK<\/h5>";case"BRITANNICA":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;BRITANNICA<\/h5>";case"PROQUEST":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;PROQUEST<\/h5>";case"TV4EDUCATION":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;TV4EDUCATION<\/h5>";case"YOUTUBE":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;YOUTUBE<\/h5>";case"CATALOGUE":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;CATALOGUE<\/h5>";case"FILE":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;FILE<\/h5>";case"URL":return"<h5>&nbsp;&nbsp;&nbsp;&nbsp;URL<\/h5>"}return""};n.fn.smlib_listbuilder_create.smlib_ItemList_MapItemType=function(n){switch(n.type.toUpperCase()){case"CATALOGUE":return"";case"FILE":return"";case"YOUTUBE":return"";case"URL":default:return""}};n.fn.smlib_listbuilder_create.smlib_ItemList_Load=function(t){var i,u,r;for(t==null?t=this.focuslist:this.focuslist=t,i=this.focuslist.desc,i.length>50&&(i=i.substr(0,50)+"..."),n("#"+this.smlibid+"_itemlist_headerdiv").html('<h5><a onclick="'+this.smlib_AssignParentActions("smlib_ItemList_HeaderClick()")+'">'+this.focuslist.name+'<\/a>&nbsp;&nbsp;&nbsp;&nbsp;<input type="checkbox" id="'+this.smlibid+'_itemlist_autoadd" class="form-input" onchange="'+this.smlib_AssignParentActions("smlib_ItemList_AutoAddChange()")+'"/>&nbsp;Quick Add<\/h5><h5>&nbsp;&nbsp;&nbsp;&nbsp;'+i+"<\/h5>"),this.smlib_listbuilder_create_options.autoadd&&(document.getElementById(this.smlibid+"_itemlist_autoadd").checked=!0),n("#"+this.smlibid+"_itemlist_contentdiv").html('<div id="'+this.smlibid+'_itemlist_contentdiv_occupy" style="z-index:200px;position:relative;height:0px;">&nbsp;<\/div>'),u=1,r=0;r<t.item.length;r++)n("#"+this.smlibid+"_itemlist_contentdiv_occupy").append(this.smlib_ItemList_ListItemDiv(t.item[r],u)),u+=n("#"+this.smlibid+"_listitemdiv_"+t.item[r].index).innerHeight()+10;n("#"+this.smlibid+"_itemlist_contentdiv_occupy").css({height:u+"px"});n(".listitemdragdiv").mousedown(function(t){if(t.which===1){var i=n("#"+n(this).attr("listitemdivid")),a=i.attr("id"),s=i.attr("smlibid"),v=i.parent().innerHeight(),h=parseInt(i.css("top")),c=i.position().top,l=t.clientY,f=c,u=i.prev(".listitem"),r=i.next(".listitem"),e=u.length>0?u.position().top:"",o=r.length>0?r.position().top:"";n(window).on("mousemove",function(n){var s,c,t;i.addClass("drag");s=f>i.position().top?"up":"down";c=h+(n.clientY-l);f=i.position().top;i.css({top:c+"px"});s=="down"&&o!=""?f>o+(r.outerHeight(!0)-i.outerHeight(!0))&&(r.css({top:parseInt(r.css("top"))-i.outerHeight(!0)+"px"}),t=r.attr("smlib-order"),r.attr("smlib-order",i.attr("smlib-order")),i.attr("smlib-order",t),u=r,r=r.nextAll(".listitem:not(.drag)").first(),e=u.length>0?u.position().top:"",o=r.length>0?r.position().top:""):s=="up"&&e!=""&&f<e&&(u.css({top:parseInt(u.css("top"))+i.outerHeight(!0)+"px"}),t=u.attr("smlib-order"),u.attr("smlib-order",i.attr("smlib-order")),i.attr("smlib-order",t),r=u,u=u.prevAll(".listitem:not(.drag)").first(),e=u.length>0?u.position().top:"",o=r.length>0?r.position().top:"")});n(window).on("mouseup",function(t){if(t.which===1){n(".listitem").removeClass("drag");n(window).off("mouseup mousemove");var i=null;i=document.getElementById(s+"_hiddenbutton");i!=null&&i.parent.smlib_ItemList_ReorderItems()}})}})};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDiv=function(n,t){var i="",r,u;return i+='<div class="itemdiv listitem"  id="'+this.smlibid+"_listitemdiv_"+n.index+'" smlibid="'+this.smlibid+'" smlib-order="'+n.index+'" style="top:'+t+'px;">',i+="<h5>",r=this.smlib_ItemList_MapItemType(n),r!=""&&(i+=r,i+="&nbsp;&nbsp;"),i+='<strong role="button" onclick="'+this.smlib_AssignParentActions("smlib_ItemList_ListItemClick('"+n.id+"')")+'">'+n.title+"<\/strong>",i+='&nbsp;&nbsp;&nbsp;&nbsp;<a href="'+n.url+'" target="_blank">',i+='<i class="fa fa-eye fa-fw"><\/i>',i+="<\/a>",i+='&nbsp;&nbsp;<i class="fa fa-arrows-v fa-fw listitemdragdiv" listitemdivid="'+this.smlibid+"_listitemdiv_"+n.index+'"><\/i>',i+='&nbsp;&nbsp;<i class="fa fa-pencil-square-o fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_ItemList_ListItemEditClick('"+n.id+"')")+'"><\/i>',i+='&nbsp;&nbsp;<i class="fa fa-trash fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_ItemList_ListItemDeleteClick('"+n.id+"')")+'"><\/i>',i+="<\/h5>",u=this.smlib_ItemList_MapItemLogo(n),u!=""&&(i+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;",i+=u,i+="&nbsp;&nbsp;",i+="<\/h5>"),i+="<h5>&nbsp;&nbsp;&nbsp;&nbsp;By "+n.creator+" On "+n.creation+"<\/h5>",i+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ItemList_HeaderClick=function(){this.smlib_Content_LoadContent("BUILDER_LIST")};n.fn.smlib_listbuilder_create.smlib_ItemList_AutoAddChange=function(){this.smlib_listbuilder_create_options.autoadd=document.getElementById(this.smlibid+"_itemlist_autoadd").checked};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemClick=function(n){var t=this.smlib_ItemList_GetItemByID(n);t!=null&&(this.focusitem=t,this.smlib_Content_LoadContent("ITEM_DETAIL"))};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemEditClick=function(n){var t=this.smlib_ItemList_GetItemByID(n);t!=null&&(this.focusitem=t,this.smlib_Content_LoadContent("EDIT_ITEM"))};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteClick=function(n){var t=this.smlib_ItemList_GetItemByID(n);t!=null&&this.smlib_ItemList_ListItemDeleteService(t)};n.fn.smlib_listbuilder_create.smlib_ItemList_ReorderItems=function(){for(var r,i="",u=0,t=0;t<this.focuslist.item.length;t++)r=parseInt(n("#"+this.smlibid+"_listitemdiv_"+this.focuslist.item[t].index).attr("smlib-order")),isNaN(r)&&(r=1),this.focuslist.item[t].index!=r&&(this.focuslist.item[t].index=r,i=i+',"id'+u+'":"'+this.focuslist.item[t].id+'","order'+u+'":"'+this.focuslist.item[t].index+'"',u++);i='{"listid": "'+this.focuslist.id+'"'+i+"}";this.smlib_ItemList_ReorderItemService(i)};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemSaveService=function(t){var r,i;for(t==null&&(t=this.focusitem),r=!0,i=0;i<this.focuslist.item.length;i++)if(this.focuslist.item[i].url.toUpperCase()==t.url.toUpperCase()){r=!1;break}r?(this.smlibShowLoadingMask("Save Item..."),n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.saveitemservice,data:'{"id": "'+t.id+'", "listid": "'+this.focuslist.id+'", "title": "'+t.title.replace(/"/g,'\\"')+'", "desc":"'+t.desc.replace(/"/g,'\\"')+'", "index":"'+t.index+'", "type":"'+t.type+'", "refid":"'+t.refid+'", "url":"'+t.url+'", "itemcover":"'+t.itemcover+'", "itemlogo":"'+t.itemlogo+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_ItemList_ListItemSaveServiceResult(JSON.parse(n.d))}catch(t){alert("Save Item Fail "+t)}},failure:function(n){alert("Save Item Fail "+n)}})):this.smlib_Content_LoadContent("ITEM_LIST")};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemSaveServiceResult=function(n){this.smlib_ItemList_GetItemByID(n.id,n)==null&&(this.focuslist.item[this.focuslist.item.length]=n);this.smlib_BuilderList_GetListByID(this.focuslist.id,this.focuslist);this.smlibHideLoadingMask();this.smlib_Content_LoadContent("ITEM_LIST")};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteService=function(t){t==null&&(t=this.focusitem);this.smlibShowLoadingMask("Delete Item...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.deleteitemservice,data:'{"id": "'+t.id+'", "listid": "'+this.focuslist.id+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_ItemList_ListItemDeleteServiceResult(JSON.parse(n.d))}catch(t){alert("Delete Item Fail "+t)}},failure:function(n){alert("Delete Item Fail "+n)}})};n.fn.smlib_listbuilder_create.smlib_ItemList_ListItemDeleteServiceResult=function(n){var t=this.focuslist,r=t.item,i;for(t.item=[],i=0;i<r.length;i++)r[i].id==n.id||(t.item[t.item.length]=r[i]);this.focuslist=t;this.smlib_BuilderList_GetListByID(this.focuslist.id,this.focuslist);this.smlibHideLoadingMask();this.smlib_Content_LoadContent("ITEM_LIST")};n.fn.smlib_listbuilder_create.smlib_ItemList_ReorderItemService=function(t){t==null&&(t='{"listid": "'+this.focuslist.id+'"}');this.smlibShowLoadingMask("Reorder List...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.reorderitemservice,data:JSON.parse(t),async:!0,success:function(n){try{this.parent.smlib_ListForm_AddServiceResult(n)}catch(t){alert("Reorder Item Fail "+t)}},failure:function(n){alert("Reorder Item Fail "+n)}})}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_ItemDetail_InnerHTML=function(t){var i="";return i+="<div ",i+='id="'+t+'_itemdetail_headerdiv" ',i+='class="header" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_ItemDetail_HeaderClick()",t)+'"',i+=">",i+="<h5>Item Detail<\/h5>",i+="<\/div>",i+="<div ",i+='id="'+t+'_itemdetail_contentdiv" ',i+='class="content" ',i+=">",i+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ItemDetail_AssignFunctions=function(t){n.fn.smlib_listbuilder_create.smlib_ItemDetail_AssignControls(t);t.smlib_ItemDetail_Load=n.fn.smlib_listbuilder_create.smlib_ItemDetail_Load;t.smlib_ItemDetail_ListItemDiv=n.fn.smlib_listbuilder_create.smlib_ItemDetail_ListItemDiv;t.smlib_ItemDetail_HeaderClick=n.fn.smlib_listbuilder_create.smlib_ItemDetail_HeaderClick};n.fn.smlib_listbuilder_create.smlib_ItemDetail_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_ItemDetail_Load=function(t){t==null?t=this.focusitem:this.focusitem=t;n("#"+this.smlibid+"_itemdetail_headerdiv").html("<h5>"+this.focuslist.name+"<\/h5>");n("#"+this.smlibid+"_itemdetail_contentdiv").html("");n("#"+this.smlibid+"_itemdetail_contentdiv").append(this.smlib_ItemDetail_ListItemDiv(t))};n.fn.smlib_listbuilder_create.smlib_ItemDetail_ListItemDiv=function(n){n==null?n=this.focusitem:this.focusitem=n;var t="";return t+='<div class="itemdiv">',t+="<h5>",t+='<a href="'+n.url+'" target="_blank">',t+="<strong>"+n.title+"<\/strong>",t+="<\/a>",t+="<\/h5>",t+='<div style="width:100%;display:inline-block;">',t+='<div class="cover">',n.itemcover!=""&&(t+='<img src="'+n.itemcover+'" alt="No Cover"   style="width:100%;min-width:100%;max-width:100%;"/>'),t+="<\/div>",t+='<div class="halfdetil"><h5>',t+=n.desc,t+="<\/h5><h5>",t+='&nbsp;&nbsp;<i class="fa fa-trash fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_ItemList_ListItemDeleteClick('"+n.id+"')")+'"><\/i>',t+="<\/h5><\/div>",t+="<\/div>",t+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ItemDetail_HeaderClick=function(){this.smlib_Content_LoadContent("ITEM_LIST")}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_BookForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_bookform_headerdiv" ',r+='class="header form"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<input class="form-control" placeholder="Keywrods in Catalogue Title" id="'+t+'_bookform_searchbox" onchange="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_BookForm_SearchClick()",t)+'">',r+='<span class="input-group-addon" role="button"  ><i id="'+t+'_bookform_searchbtn" class="fa fa-search fa-fw" style="width:auto;" ><\/i><\/span>',r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_bookform_contentdiv" ',r+='class="content form" style="height:'+(i.height-100)+"px;min-height:"+(i.height-100)+"px;max-height:"+(i.height-100)+'px"',r+=">",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_BookForm_AssignFunctions=function(t){t.smlib_BookForm_ShowLoading=n.fn.smlib_listbuilder_create.smlib_BookForm_ShowLoading;t.smlib_BookForm_HideLoading=n.fn.smlib_listbuilder_create.smlib_BookForm_HideLoading;t.smlib_BookForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_BookForm_InputFocus;t.smlib_BookForm_SearchClick=n.fn.smlib_listbuilder_create.smlib_BookForm_SearchClick;t.smlib_BookForm_SearchService=n.fn.smlib_listbuilder_create.smlib_BookForm_SearchService;t.smlib_BookForm_SearchServiceResult=n.fn.smlib_listbuilder_create.smlib_BookForm_SearchServiceResult;t.smlib_BookForm_ListItemClick=n.fn.smlib_listbuilder_create.smlib_BookForm_ListItemClick;t.smlib_BookForm_LoadMoreClick=n.fn.smlib_listbuilder_create.smlib_BookForm_LoadMoreClick;n.fn.smlib_listbuilder_create.smlib_BookForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_BookForm_AssignControls=function(n){n.bookkeyword="";n.bookpagenumber=1;n.bookresultset=[]};n.fn.smlib_listbuilder_create.smlib_BookForm_ShowLoading=function(){this.smlibShowLoadingMask("Searching Catalogue...");n("#"+this.smlibid+"_bookform_searchbtn").removeClass("fa-search");n("#"+this.smlibid+"_bookform_searchbtn").removeClass("fa-fw");n("#"+this.smlibid+"_bookform_searchbtn").addClass("fa-spinner");n("#"+this.smlibid+"_bookform_searchbtn").addClass("fa-spin")};n.fn.smlib_listbuilder_create.smlib_BookForm_HideLoading=function(){n("#"+this.smlibid+"_bookform_searchbtn").removeClass("fa-spinner");n("#"+this.smlibid+"_bookform_searchbtn").removeClass("fa-spin");n("#"+this.smlibid+"_bookform_searchbtn").addClass("fa-search");n("#"+this.smlibid+"_bookform_searchbtn").addClass("fa-fw");this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_BookForm_InputFocus=function(){n("#"+this.smlibid+"_bookform_searchbox").focus()};n.fn.smlib_listbuilder_create.smlib_BookForm_SearchClick=function(){var t=n("#"+this.smlibid+"_bookform_searchbox").val();t==""?alert("Please input a search keyword first."):(this.bookpagenumber=1,this.smlib_BookForm_SearchService(t,1,!0))};n.fn.smlib_listbuilder_create.smlib_BookForm_ListItemClick=function(t){var i=new n.fn.smlib_listbuilder_item;i.id="";i.title=this.bookresultset[t].title;i.desc=this.bookresultset[t].description;i.index=this.focuslist.item.length+1;i.type="CATALOGUE";i.refid=this.bookresultset[t].bookid;i.url=this.smlib_listbuilder_create_options.titleroot+this.bookresultset[t].bookid;i.creator="";i.creation="";i.itemcover=this.bookresultset[t].coverurl;i.itemlogo="";i.msg="";this.smlib_ItemList_ListItemSaveService(i)};n.fn.smlib_listbuilder_create.smlib_BookForm_LoadMoreClick=function(){this.bookpagenumber++;this.smlib_BookForm_SearchService(this.bookkeyword,this.bookpagenumber,!0)};n.fn.smlib_listbuilder_create.smlib_BookForm_SearchService=function(t,i,r){this.smlib_BookForm_ShowLoading();r==null&&(r=!1);(i==null||i==1)&&(i=1,n("#"+this.smlibid+"_bookform_contentdiv").html(""),this.bookresultset=[]);this.bookkeyword=t;n.ajax({parent:this,loadmore:r,type:"POST",url:this.smlib_listbuilder_create_options.booksearchservice,data:'{"Keyword": "'+t+'", "Count": '+this.smlib_listbuilder_create_options.maxsearchresult+', "Page": '+i+', "OrderBy": "TITLERELEVANT", "OrderByDirection": "ASC"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(t){try{this.parent.smlib_BookForm_SearchServiceResult(JSON.parse(t.d),this.loadmore)}catch(i){n("#"+this.parent.smlibid+"_bookform_contentdiv").html("Search Book Fail "+i)}},failure:function(t){n("#"+this.parent.smlibid+"_bookform_contentdiv").html("Search Book Fail "+t)}})};n.fn.smlib_listbuilder_create.smlib_BookForm_SearchServiceResult=function(t,i){var u,r;for(this.smlib_BookForm_HideLoading(),n("#"+this.smlibid+"_bookform_loadmore").remove(),u=0;u<t.item.length;u++)r="",r+='<div class="itemdiv">',r+="<h5>",r+='<a href="'+this.smlib_listbuilder_create_options.titleroot+t.item[u].bookid+'" target="_blank">',r+="<strong>"+t.item[u].title+"<\/strong>",r+="<\/a>",r+="<\/h5>",r+='<div style="width:100%;display:inline-block;">',r+='<div class="cover">',r+=t.item[u].coverurl!=""?'<img src="'+t.item[u].coverurl+'" alt="No Cover"   style="width:100%;min-width:100%;max-width:100%;"/>':'<img src="'+this.smlib_listbuilder_create_options.webroot+'Cover/NoCover.jpg" alt="No Cover"   style="width:100%;min-width:100%;max-width:100%;"/>',r+='<br/><i class="fa fa-plus fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_BookForm_ListItemClick("+this.bookresultset.length+")")+'"><\/i>',r+="<\/div>",r+='<div class="halfdetil"><h5>',r+=t.item[u].description,r+="<\/h5><h5>",r+="<\/h5><\/div>",r+="<\/div>",r+="<\/div>",this.bookresultset[this.bookresultset.length]=t.item[u],n("#"+this.smlibid+"_bookform_contentdiv").append(r);i&&(r="",r+='<div id="'+this.smlibid+'_bookform_loadmore"  class="itemdiv" style="margin-left:0px;margin-bottom:10px;text-align:center" onclick="'+this.smlib_AssignParentActions("smlib_BookForm_LoadMoreClick()")+'">',r+='<h4 role="button" class="btn btn-primary" style="width:80%;">',r+="Load More",r+="<\/h4>",r+="<\/div>",n("#"+this.smlibid+"_bookform_contentdiv").append(r))}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_FileForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_fileform_headerdiv" ',r+='class="header form"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<input class="form-control" placeholder="Keywrods in File Name" id="'+t+'_fileform_searchbox" onchange="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_FileForm_SearchClick()",t)+'">',r+='<span class="input-group-addon" role="button"  ><i id="'+t+'_fileform_searchbtn" class="fa fa-search fa-fw" style="width:auto;" ><\/i><\/span>',r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_fileform_contentdiv" ',r+='class="content form" style="height:'+(i.height-100)+"px;min-height:"+(i.height-100)+"px;max-height:"+(i.height-100)+'px"',r+=">",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_FileForm_AssignFunctions=function(t){t.smlib_FileForm_ShowLoading=n.fn.smlib_listbuilder_create.smlib_FileForm_ShowLoading;t.smlib_FileForm_HideLoading=n.fn.smlib_listbuilder_create.smlib_FileForm_HideLoading;t.smlib_FileForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_FileForm_InputFocus;t.smlib_FileForm_SearchClick=n.fn.smlib_listbuilder_create.smlib_FileForm_SearchClick;t.smlib_FileForm_SearchService=n.fn.smlib_listbuilder_create.smlib_FileForm_SearchService;t.smlib_FileForm_SearchServiceResult=n.fn.smlib_listbuilder_create.smlib_FileForm_SearchServiceResult;t.smlib_FileForm_ListItemClick=n.fn.smlib_listbuilder_create.smlib_FileForm_ListItemClick;t.smlib_FileForm_LoadMoreClick=n.fn.smlib_listbuilder_create.smlib_FileForm_LoadMoreClick;n.fn.smlib_listbuilder_create.smlib_FileForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_FileForm_AssignControls=function(n){n.filekeyword="";n.filepagenumber=1;n.fileresultset=[]};n.fn.smlib_listbuilder_create.smlib_FileForm_ShowLoading=function(){this.smlibShowLoadingMask("Searching Files...");n("#"+this.smlibid+"_fileform_searchbtn").removeClass("fa-search");n("#"+this.smlibid+"_fileform_searchbtn").removeClass("fa-fw");n("#"+this.smlibid+"_fileform_searchbtn").addClass("fa-spinner");n("#"+this.smlibid+"_fileform_searchbtn").addClass("fa-spin")};n.fn.smlib_listbuilder_create.smlib_FileForm_HideLoading=function(){n("#"+this.smlibid+"_fileform_searchbtn").removeClass("fa-spinner");n("#"+this.smlibid+"_fileform_searchbtn").removeClass("fa-spin");n("#"+this.smlibid+"_fileform_searchbtn").addClass("fa-search");n("#"+this.smlibid+"_fileform_searchbtn").addClass("fa-fw");this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_FileForm_InputFocus=function(){n("#"+this.smlibid+"_fileform_searchbox").focus()};n.fn.smlib_listbuilder_create.smlib_FileForm_SearchClick=function(){var t=n("#"+this.smlibid+"_fileform_searchbox").val();t==""?alert("Please input a search keyword first."):(this.filepagenumber=1,this.smlib_FileForm_SearchService(t))};n.fn.smlib_listbuilder_create.smlib_FileForm_ListItemClick=function(t){var i=new n.fn.smlib_listbuilder_item;i.id="";i.title=this.fileresultset[t].name;i.desc=this.fileresultset[t].description;i.index=this.focuslist.item.length+1;i.type="FILE";i.refid=this.fileresultset[t].fileid;i.url=this.fileresultset[t].url;i.creator="";i.creation="";i.itemcover="";i.itemlogo="";i.msg="";this.smlib_ItemList_ListItemSaveService(i)};n.fn.smlib_listbuilder_create.smlib_FileForm_LoadMoreClick=function(){this.filepagenumber++;this.smlib_FileForm_SearchService(this.filekeyword,this.filepagenumber)};n.fn.smlib_listbuilder_create.smlib_FileForm_SearchService=function(t,i){this.smlib_FileForm_ShowLoading();(i==null||i==1)&&(i=1,n("#"+this.smlibid+"_fileform_contentdiv").html(""),this.fileresultset=[]);this.filekeyword=t;n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.filesearchservice,data:'{"Keyword": "'+t+'", "Count": '+this.smlib_listbuilder_create_options.maxsearchresult+', "Page": '+i+"}",contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(t){try{this.parent.smlib_FileForm_SearchServiceResult(JSON.parse(t.d))}catch(i){n("#"+this.parent.smlibid+"_fileform_contentdiv").html("Search File Fail "+i)}},failure:function(t){n("#"+this.parent.smlibid+"_fileform_contentdiv").html("Search File Fail "+t)}})};n.fn.smlib_listbuilder_create.smlib_FileForm_SearchServiceResult=function(t){var r,i;for(this.smlib_FileForm_HideLoading(),n("#"+this.smlibid+"_fileform_loadmore").remove(),r=0;r<t.item.length;r++)i="",i+='<div class="itemdiv">',i+="<h5>",i+='<a href="'+t.item[r].url+'" target="_blank">',i+="<strong>"+t.item[r].name+"<\/strong>",i+="<\/a>",i+="<\/h5>",i+='<div style="width:100%;display:inline-block;">',i+='<div class="cover">',i+='<i class="fa fa-plus fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_FileForm_ListItemClick("+this.fileresultset.length+")")+'"><\/i><br/>',i+="<\/div>",i+='<div class="halfdetil"><h5>',i+=t.item[r].description,i+="<\/h5><h5>",i+="<\/h5><\/div>",i+="<\/div>",i+="<\/div>",this.fileresultset[this.fileresultset.length]=t.item[r],n("#"+this.smlibid+"_fileform_contentdiv").append(i);i="";i+='<div id="'+this.smlibid+'_fileform_loadmore"  class="itemdiv" style="margin-left:0px;margin-bottom:10px;text-align:center" onclick="'+this.smlib_AssignParentActions("smlib_FileForm_LoadMoreClick()")+'">';i+='<h4 role="button" class="btn btn-primary" style="width:80%;">';i+="Load More";i+="<\/h4>";i+="<\/div>";n("#"+this.smlibid+"_fileform_contentdiv").append(i)}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_YouTubeForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_youtubeform_headerdiv" ',r+='class="header form"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<input class="form-control" placeholder="Keywrods in YouTube" id="'+t+'_youtubeform_searchbox" onchange="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_YouTubeForm_SearchClick()",t)+'">',r+='<span class="input-group-addon" role="button"  ><i id="'+t+'_youtubeform_searchbtn" class="fa fa-search fa-fw" style="width:auto;"><\/i><\/span>',r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_youtubeform_contentdiv" ',r+='class="content form" style="height:'+(i.height-100)+"px;min-height:"+(i.height-100)+"px;max-height:"+(i.height-100)+'px"',r+=">",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_AssignFunctions=function(t){t.smlib_YouTubeForm_ShowLoading=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_ShowLoading;t.smlib_YouTubeForm_HideLoading=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_HideLoading;t.smlib_YouTubeForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_InputFocus;t.smlib_YouTubeForm_SearchClick=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchClick;t.smlib_YouTubeForm_SearchService=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchService;t.smlib_YouTubeForm_SearchServiceResult=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchServiceResult;t.smlib_YouTubeForm_ListItemClick=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_ListItemClick;t.smlib_YouTubeForm_LoadMoreClick=n.fn.smlib_listbuilder_create.smlib_YouTubeForm_LoadMoreClick;n.fn.smlib_listbuilder_create.smlib_YouTubeForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_AssignControls=function(n){n.youtubekeyword="";n.youtubenextpagetoke="";n.youtubeprepagetoke="";n.youtuberesultset=[]};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_ShowLoading=function(){this.smlibShowLoadingMask("Searching YouTube...");n("#"+this.smlibid+"_youtubeform_searchbtn").removeClass("fa-search");n("#"+this.smlibid+"_youtubeform_searchbtn").removeClass("fa-fw");n("#"+this.smlibid+"_youtubeform_searchbtn").addClass("fa-spinner");n("#"+this.smlibid+"_youtubeform_searchbtn").addClass("fa-spin")};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_HideLoading=function(){n("#"+this.smlibid+"_youtubeform_searchbtn").removeClass("fa-spinner");n("#"+this.smlibid+"_youtubeform_searchbtn").removeClass("fa-spin");n("#"+this.smlibid+"_youtubeform_searchbtn").addClass("fa-search");n("#"+this.smlibid+"_youtubeform_searchbtn").addClass("fa-fw");this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_InputFocus=function(){n("#"+this.smlibid+"_youtubeform_searchbox").focus()};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchClick=function(){var t=n("#"+this.smlibid+"_youtubeform_searchbox").val();t==""?alert("Please input a search keyword first."):this.smlib_YouTubeForm_SearchService(t)};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_ListItemClick=function(t){var i=new n.fn.smlib_listbuilder_item;i.id="";i.title=this.youtuberesultset[t].snippet.title;i.desc=this.youtuberesultset[t].snippet.description;i.index=this.focuslist.item.length+1;i.type="YOUTUBE";i.refid=this.youtuberesultset[t].id.videoId;i.url="https://www.youtube.com/watch?v="+i.refid;i.creator="";i.creation="";i.itemcover=this.youtuberesultset[t].snippet.thumbnails.default.url;i.itemlogo="";i.msg="";this.smlib_ItemList_ListItemSaveService(i)};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_LoadMoreClick=function(){this.smlib_YouTubeForm_SearchService(this.youtubekeyword,this.youtubenextpagetoke)};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchService=function(t,i){this.smlib_YouTubeForm_ShowLoading();var r=this.smlib_listbuilder_create_options.youtubesearchservice+"?order=relevance&part=snippet&type=video&maxResults="+this.smlib_listbuilder_create_options.maxsearchresult+"&key="+this.smlib_listbuilder_create_options.youtubesearchkey+"&q="+t;i==null||i==""?(n("#"+this.smlibid+"_youtubeform_contentdiv").html(""),this.youtuberesultset=[]):r+="&pageToken="+i;this.youtubekeyword=t;n.ajax({parent:this,type:"GET",url:r,async:!0,contentType:"text/html; charset=utf-8",success:function(t){try{this.parent.smlib_YouTubeForm_SearchServiceResult(t)}catch(i){n("#"+this.parent.smlibid+"_youtubeform_contentdiv").html("Search YouTube Fail "+i)}},failure:function(t){n("#"+this.parent.smlibid+"_youtubeform_contentdiv").html("Search YouTube Fail "+t)}})};n.fn.smlib_listbuilder_create.smlib_YouTubeForm_SearchServiceResult=function(t){var r,i;for(this.smlib_YouTubeForm_HideLoading(),n("#"+this.smlibid+"_youtubeform_loadmore").remove(),this.youtubenextpagetoke=t.nextPageToken,this.youtubeprepagetoke=t.prevPageToken,this.youtubenextpagetoke==null&&(this.youtubenextpagetoke=""),this.youtubeprepagetoke==null&&(this.youtubeprepagetoke=""),r=0;r<t.items.length;r++)i="",i+='<div class="itemdiv">',i+="<h5>",i+='<a href="https://www.youtube.com/watch?v='+t.items[r].id.videoId+'" target="_blank">',i+="<strong>"+t.items[r].snippet.title+"<\/strong>",i+="<\/a>",i+="<\/h5>",i+='<div style="width:100%;display:inline-block;">',i+='<div class="cover">',t.items[r].snippet.thumbnails.default.url!=""&&(i+='<img src="'+t.items[r].snippet.thumbnails.default.url+'" alt="No Cover"   style="width:100%;min-width:100%;max-width:100%;"/>'),i+='<br/><i class="fa fa-plus fa-fw" onclick="'+this.smlib_AssignParentActions("smlib_YouTubeForm_ListItemClick("+this.youtuberesultset.length+")")+'"><\/i>',i+="<\/div>",i+='<div class="halfdetil"><h5>',i+=t.items[r].snippet.description,i+="<\/h5><h5>",i+="<\/h5><\/div>",i+="<\/div>",i+="<\/div>",this.youtuberesultset[this.youtuberesultset.length]=t.items[r],n("#"+this.smlibid+"_youtubeform_contentdiv").append(i);i="";i+='<div id="'+this.smlibid+'_youtubeform_loadmore"  class="itemdiv" style="margin-left:0px;margin-bottom:10px;text-align:center" onclick="'+this.smlib_AssignParentActions("smlib_YouTubeForm_LoadMoreClick()")+'">';i+='<h4 role="button" class="btn btn-primary" style="width:80%;">';i+="Load More";i+="<\/h4>";i+="<\/div>";n("#"+this.smlibid+"_youtubeform_contentdiv").append(i)}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_URLForm_InnerHTML=function(t,i,r){r==null&&(r="NEW");var u="";return u+="<div ",u+='id="'+t+'_urlform_headerdiv" ',u+='class="header"',u+=">",u+='<div class="input-group inputdiv" style="width:100%;">',u+='<input type="textbox" class="form-control" placeholder="Title" id="'+t+'_urlform_titlebox">',u+='<span class="input-group-addon" role="button"  >',r=="NEW"?u+='<i id="'+t+'_urlform_addbtn" class="fa fa-plus fa-fw" style="width:auto;" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_URLForm_AddClick()",t)+'"><\/i>':r=="EDIT"&&(u+='<i id="'+t+'_urlform_addbtn" class="fa fa-pencil fa-fw" style="width:auto;" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_URLForm_UpdateClick()",t)+'"><\/i>'),u+="<\/span>",u+="<\/div>",u+='<div class="input-group inputdiv" style="width:100%;">',u+='<textarea class="form-control" placeholder="URL" id="'+t+'_urlform_urlbox" rows="3"><\/textarea>',u+="<\/div>",u+='<div class="input-group inputdiv" style="width:100%;">',u+='<textarea class="form-control" placeholder="Description" id="'+t+'_urlform_descbox" rows="5"><\/textarea>',u+="<\/div>",u+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_URLForm_AssignFunctions=function(t){t.smlib_URLForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_URLForm_InputFocus;t.smlib_URLForm_LoadItem=n.fn.smlib_listbuilder_create.smlib_URLForm_LoadItem;t.smlib_URLForm_LoadBlank=n.fn.smlib_listbuilder_create.smlib_URLForm_LoadBlank;t.smlib_URLForm_AddClick=n.fn.smlib_listbuilder_create.smlib_URLForm_AddClick;t.smlib_URLForm_UpdateClick=n.fn.smlib_listbuilder_create.smlib_URLForm_UpdateClick;n.fn.smlib_listbuilder_create.smlib_URLForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_URLForm_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_URLForm_InputFocus=function(){n("#"+this.smlibid+"_urlform_titlebox").focus()};n.fn.smlib_listbuilder_create.smlib_URLForm_LoadItem=function(t){t==null&&(t=this.focusitem);n("#"+this.smlibid+"_urlform_titlebox").val(t.title);n("#"+this.smlibid+"_urlform_urlbox").val(t.url);n("#"+this.smlibid+"_urlform_descbox").val(t.desc);this.smlib_URLForm_InputFocus()};n.fn.smlib_listbuilder_create.smlib_URLForm_LoadBlank=function(){n("#"+this.smlibid+"_urlform_titlebox").val("");n("#"+this.smlibid+"_urlform_urlbox").val("");n("#"+this.smlibid+"_urlform_descbox").val("");this.smlib_URLForm_InputFocus()};n.fn.smlib_listbuilder_create.smlib_URLForm_AddClick=function(){var t=new n.fn.smlib_listbuilder_item;if(t.id="",t.title=n("#"+this.smlibid+"_urlform_titlebox").val(),t.desc=n("#"+this.smlibid+"_urlform_descbox").val(),t.index=this.focuslist.item.length+1,t.type="URL",t.refid="",t.url=n("#"+this.smlibid+"_urlform_urlbox").val(),t.creator="",t.creation="",t.itemcover="",t.itemlogo="",t.msg="",t.title==""){alert("Please input a title for the item.");return}if(t.url==""){alert("Please input a URL for the item.");return}t.url.indexOf("../")==0||t.url.toLowerCase().indexOf("http")!=0&&(t.url="https://"+t.url);this.smlib_ItemList_ListItemSaveService(t)};n.fn.smlib_listbuilder_create.smlib_URLForm_UpdateClick=function(){n("#"+this.smlibid+"_urlform_titlebox").val()!=""?(this.focusitem.title=n("#"+this.smlibid+"_urlform_titlebox").val(),this.focusitem.url=n("#"+this.smlibid+"_urlform_urlbox").val(),this.focusitem.desc=n("#"+this.smlibid+"_urlform_descbox").val(),this.smlib_ItemList_ListItemSaveService(this.focusitem)):alert("Please enter item title")}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_PrintForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_printform_headerdiv" ',r+='class="header form"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<select id="'+t+'_printform_modeselect" class="form-control" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PrintForm_LoadTemplate()",t)+'">',r+='<option value="HARVARD">Harvard Style<\/option>',r+='<option value="APA">APA Style<\/option>',r+="<\/select>",r+='<span class="input-group-addon" role="button"  onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PrintForm_ExportClick()",t)+'"><i id="'+t+'_printform_exportbtn" class="fa fa-file-pdf-o fa-fw" style="width:auto;"><\/i>&nbsp;PDF<\/span>',r+='<span class="input-group-addon" role="button"  onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PrintForm_ExportTxtClick()",t)+'"><i id="'+t+'_printform_exporttxtbtn" class="fa fa-file-pdf-o fa-fw" style="width:auto;"><\/i>&nbsp;TXT<\/span>',r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_printform_contentdiv" ',r+='class="content form" style="display:none;height:'+(i.height-100)+"px;min-height:"+(i.height-100)+"px;max-height:"+(i.height-100)+'px"',r+=">",r+='<div style="width:100%;padding-left:20px;padding-right:20px;">',r+='<h5><a role="button" data-toggle="collapse" href="#'+t+'_printform_cataloguetemplate" aria-expanded="false" aria-controls="'+t+'_printform_cataloguetemplate" style="width:100%;;max-width:100%; overflow:hidden;position: relative;display: block;text-align: left;">Catalogue Item Template<\/a><\/h5>',r+='<div id="'+t+'_printform_cataloguetemplate" class="collapse"  style="text-align: left; position: relative;width:100%;;max-width:100%; overflow:hidden;">',r+="<\/div>",r+="<\/div>",r+='<div style="width:100%;padding-left:20px;padding-right:20px;">',r+='<h5><a role="button" data-toggle="collapse" href="#'+t+'_printform_urltemplate" aria-expanded="false" aria-controls="'+t+'_printform_urltemplate" style="width:100%;;max-width:100%; overflow:hidden;position: relative;display: block;text-align: left;">URL Item Template<\/a><\/h5>',r+='<div id="'+t+'_printform_urltemplate" class="collapse"  style="text-align: left; position: relative;width:100%;;max-width:100%; overflow:hidden;">',r+="<\/div>",r+="<\/div>",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_PrintForm_AssignFunctions=function(t){t.smlib_PrintForm_LoadControls=n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadControls;t.smlib_PrintForm_LoadCatalogueTemplate=n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadCatalogueTemplate;t.smlib_PrintForm_LoadURLTemplate=n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadURLTemplate;t.smlib_PrintForm_LoadTemplate=n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadTemplate;t.smlib_PrintForm_PrintClick=n.fn.smlib_listbuilder_create.smlib_PrintForm_PrintClick;t.smlib_PrintForm_ExportClick=n.fn.smlib_listbuilder_create.smlib_PrintForm_ExportClick;t.smlib_PrintForm_ExportTxtClick=n.fn.smlib_listbuilder_create.smlib_PrintForm_ExportTxtClick;t.smlib_PrintForm_CatalogueHeaderTokenAddClick=n.fn.smlib_listbuilder_create.smlib_PrintForm_CatalogueHeaderTokenAddClick;t.smlib_PrintForm_URLHeaderTokenAddClick=n.fn.smlib_listbuilder_create.smlib_PrintForm_URLHeaderTokenAddClick;t.smlib_PrintForm_InitPDFPage=n.fn.smlib_listbuilder_create.smlib_PrintForm_InitPDFPage;t.smlib_PrintForm_GeneratePDFTableService=n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFTableService;t.smlib_PrintForm_GeneratePDFTableServiceResult=n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFTableServiceResult;t.smlib_PrintForm_GenerateCataloguePDFTableServiceResult=n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateCataloguePDFTableServiceResult;t.smlib_PrintForm_GenerateUrlPDFTableServiceResult=n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateUrlPDFTableServiceResult;t.smlib_PrintForm_PDFMapCatalogueTokenValue=n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapCatalogueTokenValue;t.smlib_PrintForm_PDFMapCatalogueHeaderValue=n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapCatalogueHeaderValue;t.smlib_PrintForm_PDFMapURLTokenValue=n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapURLTokenValue;t.smlib_PrintForm_PDFMapURLHeaderValue=n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapURLHeaderValue;t.smlib_PrintForm_GeneratePDFImages=n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFImages;t.smlib_PrintForm_GenerateTXTContentService=n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateTXTContentService;t.smlib_PrintForm_GenerateTXTContentServiceResult=n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateTXTContentServiceResult;n.fn.smlib_listbuilder_create.smlib_PrintForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_PrintForm_AssignControls=function(n){n.PDFDoc=null;n.cataloguetokencount=0;n.urltokencount=0;n.pdfimagelist={image:[]}};n.fn.smlib_listbuilder_create.smlib_PrintForm_PrintClick=function(){var t=window.open(this.smlib_listbuilder_create_options.widgetroot+"PAGE/ListPrint.html");t.focuslist=this.focuslist;t.printtype=n("#"+this.smlibid+"_printform_modeselect").val();t.smlib_listbuilder_create_options=this.smlib_listbuilder_create_options};n.fn.smlib_listbuilder_create.smlib_PrintForm_ExportTxtClick=function(){this.txtexportcontent="";switch(n("#"+this.smlibid+"_printform_modeselect").val()){case"APA":this.cataloguetemplate_titlebox="[Author].([Publisher Date]).[Title].[Publisher Place]:[Publisher]";this.urltemplate_titlebox="[Add To List By].[Title].[Add To List Date], from [URL]";break;case"HARVARD":default:this.cataloguetemplate_titlebox="[Author] [Publisher Date], [Title], [Publisher]";this.urltemplate_titlebox="[Add To List By], [Title], [Add To List Date], <[URL]>"}this.smlibShowLoadingMask("");this.focuslist.item.length>0&&this.smlib_PrintForm_GenerateTXTContentService(0)};n.fn.smlib_listbuilder_create.smlib_PrintForm_ExportClick=function(){this.PDFDoc=null;this.PDFDoc=new jsPDF({orientation:"P",unit:"mm",format:[this.smlib_listbuilder_create_options.pdfsizewidth,this.smlib_listbuilder_create_options.pdfsizeheight]});this.smlib_listbuilder_create_options.pdftablewidth=this.smlib_listbuilder_create_options.pdfsizewidth-this.smlib_listbuilder_create_options.pdfmarginleft-this.smlib_listbuilder_create_options.pdfmarginright;this.smlib_listbuilder_create_options.pdftableheight=(this.smlib_listbuilder_create_options.pdfsizeheight-this.smlib_listbuilder_create_options.pdfmargintop-this.smlib_listbuilder_create_options.pdfmarginbottom-this.smlib_listbuilder_create_options.pdfitemperpage*this.smlib_listbuilder_create_options.pdfitemmargin)/this.smlib_listbuilder_create_options.pdfitemperpage;this.smlib_listbuilder_create_options.pdfheaderwidth=this.smlib_listbuilder_create_options.pdftablewidth;this.smlib_listbuilder_create_options.pdfheaderheight=this.smlib_listbuilder_create_options.pdftableheight*.33;this.cataloguetokencount=0;this.urltokencount=0;switch(n("#"+this.smlibid+"_printform_modeselect").val()){case"APA":this.cataloguetemplate_titlebox="[Author].([Publisher Date]).[Title].[Publisher Place]:[Publisher]";this.urltemplate_titlebox="[Add To List By].[Title].[Add To List Date], from [URL]";break;case"HARVARD":default:this.cataloguetemplate_titlebox="[Author] [Publisher Date], [Title], [Publisher]";this.urltemplate_titlebox="[Add To List By], [Title], [Add To List Date], <[URL]>"}this.smlib_PrintForm_InitPDFPage();this.smlibShowLoadingMask("");this.focuslist.item.length>0&&this.smlib_PrintForm_GeneratePDFTableService(0)};n.fn.smlib_listbuilder_create.smlib_PrintForm_CatalogueHeaderTokenAddClick=function(){var i=n("#"+this.smlibid+"_printform_cataloguetemplate_titletoken").val(),t;i!="NOT_SET"&&(t=n("#"+this.smlibid+"_printform_cataloguetemplate_titletoken option:selected").text(),this.smlibInsertAtCaret(document.getElementById(this.smlibid+"_printform_cataloguetemplate_titlebox"),"["+t+"]"))};n.fn.smlib_listbuilder_create.smlib_PrintForm_URLHeaderTokenAddClick=function(){var i=n("#"+this.smlibid+"_printform_urltemplate_titletoken").val(),t;i!="NOT_SET"&&(t=n("#"+this.smlibid+"_printform_urltemplate_titletoken option:selected").text(),this.smlibInsertAtCaret(document.getElementById(this.smlibid+"_printform_urltemplate_titlebox"),"["+t+"]"))};n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadControls=function(){n("#"+this.smlibid+"_printform_cataloguetemplate").html(this.smlib_PrintForm_LoadCatalogueTemplate());n("#"+this.smlibid+"_printform_urltemplate").html(this.smlib_PrintForm_LoadURLTemplate());this.smlib_PrintForm_LoadTemplate()};n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadTemplate=function(){return};n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadCatalogueTemplate=function(){for(var n,t="",i=0;i<this.smlib_listbuilder_create_options.catalogueprinttokens.length;i++)t+='<option value="'+this.smlib_listbuilder_create_options.catalogueprinttokens[i].key+'">'+this.smlib_listbuilder_create_options.catalogueprinttokens[i].value+"<\/option>";return n="",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token One<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_token1" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Two<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_token2" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Three<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_token3" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Four<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_token4" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Five<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_token5" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;" role="button" onclick="'+this.smlib_AssignParentActions("smlib_PrintForm_CatalogueHeaderTokenAddClick()")+'"><i class="fa fa-plus fa-fw" style="width:auto;"><\/i>&nbsp;Header Token<\/span>',n+='<select id="'+this.smlibid+'_printform_cataloguetemplate_titletoken" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;" role="button">Header<\/span>',n+='<textarea id="'+this.smlibid+'_printform_cataloguetemplate_titlebox" rows="5" class="form-control" style="width:100%;"><\/textarea>',n+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_PrintForm_LoadURLTemplate=function(){for(var n,t="",i=0;i<this.smlib_listbuilder_create_options.urlprinttokens.length;i++)t+='<option value="'+this.smlib_listbuilder_create_options.urlprinttokens[i].key+'">'+this.smlib_listbuilder_create_options.urlprinttokens[i].value+"<\/option>";return n="",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token One<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_token1" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Two<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_token2" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Three<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_token3" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Four<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_token4" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;">Token Five<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_token5" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;" role="button" onclick="'+this.smlib_AssignParentActions("smlib_PrintForm_URLHeaderTokenAddClick()")+'"><i class="fa fa-plus fa-fw" style="width:auto;"><\/i>&nbsp;Header Token<\/span>',n+='<select id="'+this.smlibid+'_printform_urltemplate_titletoken" class="form-control">',n+=t,n+="<\/select>",n+="<\/div>",n+='<div class="input-group inputdiv" style="width:100%;">',n+='<span class="input-group-addon" style="width:120px;" role="button">Header<\/span>',n+='<textarea id="'+this.smlibid+'_printform_urltemplate_titlebox" rows="5" class="form-control" style="width:100%;"><\/textarea>',n+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_PrintForm_InitPDFPage=function(){this.PDFDoc.setFont(this.smlib_listbuilder_create_options.pdffont,this.smlib_listbuilder_create_options.pdffonttype);this.PDFDoc.setFontSize(this.smlib_listbuilder_create_options.pdffontsize+"");this.PDFDoc.setTextColor(0,0,0);this.PDFDoc.setFillColor(255,255,255)};n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFImages=function(n,t,i){if(t<n.length){var r=new Image;r.parent=this;r.itemindex=i;r.imagelist=n;r.imageindex=t;r.smlib_listbuilder_create_options=this.smlib_listbuilder_create_options;r.onload=function(){try{this.actwidth=n[t].width;this.actheight=this.height/this.width*this.actwidth;this.actheight>n[t].height&&(this.actheight=n[t].height,this.actwidth=this.width/this.height*this.actheight);this.leftmargin=0;this.topmargin=0;this.actwidth<n[t].width&&(this.leftmargin=(n[t].width-this.actwidth)/2);this.actheight<n[t].height&&(this.topmargin=(n[t].height-this.actheight)/2);this.parent.PDFDoc.addImage(this.src,n[t].imgtype,n[t].left+this.leftmargin,n[t].top+this.topmargin,this.actwidth,this.actheight)}catch(i){}this.parent.smlib_PrintForm_GeneratePDFImages(this.imagelist,this.imageindex+1,this.itemindex)};r.onerror=function(){this.parent.smlib_PrintForm_GeneratePDFImages(this.imagelist,this.imageindex+1,this.itemindex)};r.src=n[t].itemcoverbase64}else this.smlib_PrintForm_GeneratePDFTableService(i+1)};n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapCatalogueTokenValue=function(n,t){switch(t.toUpperCase()){case"NOT_SET":return"";case"ADD_PATRON":return n.creatorname;case"ADD_DATE":return n.creation;case"AUTHOR":return n.author;case"CATALOGUER":return n.cataloguer;case"CATALOGUE_DATE":return n.cataloguedate;case"COVER":return"N/A";case"DESCRIPTION":return n.desc;case"ISBN":return n.isbn;case"PUBLISHER":return n.publisher;case"PUBLISHER_WITH_PLACE":return n.publisher+" "+n.publisherplace;case"PUBLISHER_DATE":return n.publisherdate;case"PUBLISHER_PLACE":return n.publisherplace;case"SERIES":return n.series;case"URL":return n.url;case"TITLE":default:return n.title}};n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapCatalogueHeaderValue=function(n,t){return t=n.creatorname==""?t.replace(/\[Add To List By\]/g,"N/A"):t.replace(/\[Add To List By\]/g,n.creatorname),t=n.creation==""?t.replace(/\[Add To List Date\]/g,"N/A"):t.replace(/\[Add To List Date\]/g,n.creation),t=n.author==""?t.replace(/\[Author\]/g,"N/A"):t.replace(/\[Author\]/g,n.author),t=n.cataloguer==""?t.replace(/\[Catalogue By\]/g,"N/A"):t.replace(/\[Catalogue By\]/g,n.cataloguer),t=n.cataloguedate==""?t.replace(/\[Catalogue Date\]/g,"N/A"):t.replace(/\[Catalogue Date\]/g,n.cataloguedate),t=n.itemcover==""?t.replace(/\[Cover\]/g,""):t.replace(/\[Cover\]/g,""),t=n.desc==""?t.replace(/\[Description\]/g,"N/A"):t.replace(/\[Description\]/g,n.desc),t=n.isbn==""?t.replace(/\[ISBN\]/g,"N/A"):t.replace(/\[ISBN\]/g,n.isbn),t=n.publisher==""?t.replace(/\[Publisher\]/g,"N/A"):t.replace(/\[Publisher\]/g,n.publisher),t=n.publisher+" "+n.publisherplace==""?t.replace(/\[Publisher \/ Place\]/g,"N/A"):t.replace(/\[Publisher \/ Place\]/g,n.publisher+" "+n.publisherplace),t=n.publisherdate==""?t.replace(/\[Publisher Date\]/g,"N/A"):t.replace(/\[Publisher Date\]/g,n.publisherdate),t=n.publisherplace==""?t.replace(/\[Publisher Place\]/g,"N/A"):t.replace(/\[Publisher Place\]/g,n.publisherplace),t=n.series==""?t.replace(/\[Series\]/g,"N/A"):t.replace(/\[Series\]/g,n.series),t=n.title==""?t.replace(/\[Title\]/g,"N/A"):t.replace(/\[Title\]/g,n.title),n.url==""?t.replace(/\[URL\]/g,"N/A"):t.replace(/\[URL\]/g,n.url)};n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapURLTokenValue=function(n,t){switch(t.toUpperCase()){case"NOT_SET":return"";case"ADD_PATRON":return n.creatorname;case"ADD_DATE":return n.creation;case"COVER":return"N/A";case"DESCRIPTION":return n.desc;case"URL":return n.url;case"TITLE":default:return n.title}};n.fn.smlib_listbuilder_create.smlib_PrintForm_PDFMapURLHeaderValue=function(n,t){return t=n.creatorname==""?t.replace(/\[Add To List By\]/g,"N/A"):t.replace(/\[Add To List By\]/g,n.creatorname),t=n.creation==""?t.replace(/\[Add To List Date\]/g,"N/A"):t.replace(/\[Add To List Date\]/g,n.creation),t=n.itemcover==""?t.replace(/\[Cover\]/g,""):t.replace(/\[Cover\]/g,""),t=n.desc==""?t.replace(/\[Description\]/g,"N/A"):t.replace(/\[Description\]/g,n.desc),t=n.title==""?t.replace(/\[Title\]/g,"N/A"):t.replace(/\[Title\]/g,n.title),n.url==""?t.replace(/\[URL\]/g,"N/A"):t.replace(/\[URL\]/g,n.url)};n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateTXTContentService=function(t){if(t<this.focuslist.item.length)this.smlibShowLoadingMask("Export Item "+(t+1)),n.ajax({parent:this,parentindex:t,type:"POST",url:this.smlib_listbuilder_create_options.getitemdetailservice,data:'{"id": "'+this.focuslist.item[t].id+'", "listid": "'+this.focuslist.id+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){try{this.parent.smlib_PrintForm_GenerateTXTContentServiceResult(JSON.parse(n.d),this.parentindex)}catch(t){}},failure:function(){}});else{this.smlibHideLoadingMask();var i=new Date,a=i.getDay(),h=i.getFullYear(),u=i.getMonth()+1,f=i.getDate(),e=i.getHours(),o=i.getMinutes(),s=i.getSeconds();f<10&&(f="0"+f);u<10&&(u="0"+u);e<10&&(e="0"+e);o<10&&(o="0"+o);s<10&&(s="0"+s);var c=this.focuslist.name+"_"+h+""+u+""+f+".txt",l="data:application/octet-stream,"+encodeURIComponent(this.txtexportcontent),r=document.createElement("a");r.href=l;r.download=c;document.body.appendChild(r);r.click();document.body.removeChild(r)}};n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateTXTContentServiceResult=function(n,t){var i="";i=n.type=="CATALOGUE"?this.smlib_PrintForm_PDFMapCatalogueHeaderValue(n,this.cataloguetemplate_titlebox):this.smlib_PrintForm_PDFMapURLHeaderValue(n,this.urltemplate_titlebox);i==""&&(i="N/A");this.txtexportcontent+=i+"\r\n";this.smlib_PrintForm_GenerateTXTContentService(t+1)};n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFTableService=function(t){if(t<this.focuslist.item.length)this.smlibShowLoadingMask("Export Item "+(t+1)),n.ajax({parent:this,parentindex:t,type:"POST",url:this.smlib_listbuilder_create_options.getitemdetailservice,data:'{"id": "'+this.focuslist.item[t].id+'", "listid": "'+this.focuslist.id+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){try{this.parent.smlib_PrintForm_GeneratePDFTableServiceResult(JSON.parse(n.d),this.parentindex)}catch(t){}},failure:function(){}});else{this.smlibHideLoadingMask();var i=new Date,h=i.getDay(),s=i.getFullYear(),r=i.getMonth()+1,u=i.getDate(),f=i.getHours(),e=i.getMinutes(),o=i.getSeconds();u<10&&(u="0"+u);r<10&&(r="0"+r);f<10&&(f="0"+f);e<10&&(e="0"+e);o<10&&(o="0"+o);this.PDFDoc.save(this.focuslist.name+"_"+s+""+r+""+u+".pdf")}};n.fn.smlib_listbuilder_create.smlib_PrintForm_GeneratePDFTableServiceResult=function(n,t){n.msg==""&&(this.pdfimagelist.image=[],n.type=="CATALOGUE"?this.smlib_PrintForm_GenerateCataloguePDFTableServiceResult(n,t):this.smlib_PrintForm_GenerateUrlPDFTableServiceResult(n,t))};n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateCataloguePDFTableServiceResult=function(n,t){var u=t%this.smlib_listbuilder_create_options.pdfitemperpage,r,f,i;for(t>0&&u==0&&this.PDFDoc.addPage(),this.PDFDoc.rect(this.smlib_listbuilder_create_options.pdfmarginleft,this.smlib_listbuilder_create_options.pdfmargintop+u*(this.smlib_listbuilder_create_options.pdftableheight+this.smlib_listbuilder_create_options.pdfitemmargin),this.smlib_listbuilder_create_options.pdfheaderwidth,this.smlib_listbuilder_create_options.pdftableheight,"D"),r=this.smlib_PrintForm_PDFMapCatalogueHeaderValue(n,this.cataloguetemplate_titlebox),r==""&&(r="N/A"),f=this.PDFDoc.splitTextToSize(r,this.smlib_listbuilder_create_options.pdfheaderwidth),i=0;i<Math.floor(this.smlib_listbuilder_create_options.pdftableheight/this.smlib_listbuilder_create_options.pdffontheightrate);i++)if(i>f.length-1)break;else this.PDFDoc.text(f[i],this.smlib_listbuilder_create_options.pdfmarginleft+this.smlib_listbuilder_create_options.pdfheaderwidth/2,this.smlib_listbuilder_create_options.pdfmargintop+u*(this.smlib_listbuilder_create_options.pdftableheight+this.smlib_listbuilder_create_options.pdfitemmargin)+this.smlib_listbuilder_create_options.pdffontsize/this.smlib_listbuilder_create_options.pdffontwidthrate*(i+1),"center");this.pdfimagelist.image.length>0?this.smlib_PrintForm_GeneratePDFImages(this.pdfimagelist.image,0,t):this.smlib_PrintForm_GeneratePDFTableService(t+1)};n.fn.smlib_listbuilder_create.smlib_PrintForm_GenerateUrlPDFTableServiceResult=function(n,t){var u=t%this.smlib_listbuilder_create_options.pdfitemperpage,r,f,i;for(t>0&&u==0&&this.PDFDoc.addPage(),this.PDFDoc.rect(this.smlib_listbuilder_create_options.pdfmarginleft,this.smlib_listbuilder_create_options.pdfmargintop+u*(this.smlib_listbuilder_create_options.pdftableheight+this.smlib_listbuilder_create_options.pdfitemmargin),this.smlib_listbuilder_create_options.pdfheaderwidth,this.smlib_listbuilder_create_options.pdftableheight,"D"),r=this.smlib_PrintForm_PDFMapURLHeaderValue(n,this.urltemplate_titlebox),r==""&&(r="N/A"),f=this.PDFDoc.splitTextToSize(r,this.smlib_listbuilder_create_options.pdfheaderwidth),i=0;i<Math.floor(this.smlib_listbuilder_create_options.pdftableheight/this.smlib_listbuilder_create_options.pdffontheightrate);i++)if(i>f.length-1)break;else this.PDFDoc.text(f[i],this.smlib_listbuilder_create_options.pdfmarginleft+this.smlib_listbuilder_create_options.pdfheaderwidth/2,this.smlib_listbuilder_create_options.pdfmargintop+u*(this.smlib_listbuilder_create_options.pdftableheight+this.smlib_listbuilder_create_options.pdfitemmargin)+this.smlib_listbuilder_create_options.pdffontsize/this.smlib_listbuilder_create_options.pdffontwidthrate*(i+1),"center");this.pdfimagelist.image.length>0?this.smlib_PrintForm_GeneratePDFImages(this.pdfimagelist.image,0,t):this.smlib_PrintForm_GeneratePDFTableService(t+1)}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_ShareForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_shareform_headerdiv" ',r+='class="header"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<input style="width:100%;" class="form-control" placeholder="Email Address" id="'+t+'_shareform_emailbox" >',r+='<select style="width:100%;" class="form-control"  id="'+t+'_shareform_typebox" >',r+='<option value="READONLY">Static List<\/option>',r+='<option value="COLLABORATE">Collaborative List<\/option>',r+="<\/select>",r+='<span class="input-group-addon" role="button" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_ShareForm_AddClick()",t)+'" ><i id="'+t+'_shareform_searchbtn" class="fa fa-plus fa-fw" style="width:auto;"><\/i>&nbsp;Share<\/span>',i.showsearchuserbtn&&(r+='<span class="input-group-addon" role="button" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_ShareForm_SearchUserClick()",t)+'" ><i id="'+t+'_shareform_searchuserbtn" class="fa fa-search fa-fw" style="width:auto;"><\/i>&nbsp;Search<\/span>'),r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_shareform_contentdiv" ',r+='class="content" style="height:'+(i.height-150)+"px;min-height:"+(i.height-150)+"px;max-height:"+(i.height-150)+'px"',r+=">",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ShareForm_AssignFunctions=function(t){t.smlib_ShareForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_ShareForm_InputFocus;t.smlib_ShareForm_LoadList=n.fn.smlib_listbuilder_create.smlib_ShareForm_LoadList;t.smlib_ShareForm_ListItemDiv=n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemDiv;t.smlib_ShareForm_AddClick=n.fn.smlib_listbuilder_create.smlib_ShareForm_AddClick;t.smlib_ShareForm_ListItemDeleteClick=n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemDeleteClick;t.smlib_ShareForm_ListItemEmailClick=n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemEmailClick;t.smlib_ShareForm_AddService=n.fn.smlib_listbuilder_create.smlib_ShareForm_AddService;t.smlib_ShareForm_AddServiceResult=n.fn.smlib_listbuilder_create.smlib_ShareForm_AddServiceResult;t.smlib_ShareForm_DeleteService=n.fn.smlib_listbuilder_create.smlib_ShareForm_DeleteService;t.smlib_ShareForm_DeleteServiceResult=n.fn.smlib_listbuilder_create.smlib_ShareForm_DeleteServiceResult;t.smlib_ShareForm_ListItemTypeChangeClick=n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemTypeChangeClick;t.smlib_ShareForm_SearchUserClick=n.fn.smlib_listbuilder_create.smlib_ShareForm_SearchUserClick;n.fn.smlib_listbuilder_create.smlib_ShareForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_ShareForm_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_ShareForm_InputFocus=function(){n("#"+this.smlibid+"_shareform_emailbox").focus()};n.fn.smlib_listbuilder_create.smlib_ShareForm_LoadList=function(t){t==null&&(t=this.focuslist);n("#"+this.smlibid+"_shareform_contentdiv").html("");for(var i=0;i<t.shared.length;i++)n("#"+this.smlibid+"_shareform_contentdiv").append(this.smlib_ShareForm_ListItemDiv(t.shared[i]));n("#"+this.smlibid+"_shareform_emailbox").val("");this.smlib_ShareForm_InputFocus()};n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemDiv=function(n){var t="";t+='<div class="itemdiv">';t+="<h5>";t+="<strong>"+n.name+"<\/strong>&nbsp;&nbsp;";switch(n.type.toUpperCase()){case"READONLY":t+='<select style="width: 200px;display: inline-block;float:right;margin-right:50px;margin-top: 0px;" id="'+this.smlibid+"_buildlist_listtype"+n.refid.replace(/\./g,"_")+'" onchange="'+this.smlib_AssignParentActions("smlib_ShareForm_ListItemTypeChangeClick('"+n.refid+"')")+'" class=""><option value="READONLY" selected>Static List<\/option><option value="COLLABORATE">Collaborative List<\/option><\/select>';break;case"COLLABORATE":t+='<select style="width: 200px;display: inline-block;float:right;margin-right:50px;margin-top: 0px;" id="'+this.smlibid+"_buildlist_listtype"+n.refid.replace(/\./g,"_")+'" onchange="'+this.smlib_AssignParentActions("smlib_ShareForm_ListItemTypeChangeClick('"+n.refid+"')")+'" class=""><option value="READONLY">Static List<\/option><option value="COLLABORATE" selected>Collaborative List<\/option><\/select>'}return t+="<br/>&nbsp;&nbsp;&nbsp;&nbsp;"+n.email+"",t+='&nbsp;&nbsp;<i class="fa fa-envelope fa-fw" role="button" onclick="'+this.smlib_AssignParentActions("smlib_ShareForm_ListItemEmailClick('"+n.index+"')")+'"><\/i>',t+='&nbsp;&nbsp;<i class="fa fa-trash fa-fw" role="button" onclick="'+this.smlib_AssignParentActions("smlib_ShareForm_ListItemDeleteClick('"+n.index+"')")+'"><\/i>',t+="<\/h5>",t+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_ShareForm_AddClick=function(){var t=n("#"+this.smlibid+"_shareform_emailbox").val(),i;t==""?alert("Please input an email address first."):(i=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,i.test(t)?this.smlib_ShareForm_AddService(t,n("#"+this.smlibid+"_shareform_typebox").val()):alert("Please input an validated email address."))};n.fn.smlib_listbuilder_create.smlib_ShareForm_SearchUserClick=function(){this.smlib_Content_LoadContent("PATRON_FORM")};n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemDeleteClick=function(n){for(var t=0;t<this.focuslist.shared.length;t++)if(this.focuslist.shared[t].index==n){this.smlib_ShareForm_DeleteService(this.focuslist.shared[t].email);return}};n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemTypeChangeClick=function(t){this.smlibShowLoadingMask("Alter Shared Type...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.sharetypechangeservice,data:'{"listid": "'+this.focuslist.id+'", "refid": "'+t+'", "type":"'+n("#"+this.smlibid+"_buildlist_listtype"+t.replace(/\./g,"_")).val()+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{for(var t=0;t<this.parent.focuslist.shared.length;t++)this.parent.focuslist.shared[t].email.toUpperCase()==JSON.parse(n.d).email.toUpperCase()&&(this.parent.focuslist.shared[t].type=JSON.parse(n.d).type);this.parent.smlibHideLoadingMask()}catch(i){alert("Alter Share Type Fail "+i);this.parent.smlibHideLoadingMask()}},failure:function(n){alert("Alter Share Type "+n);this.parent.smlibHideLoadingMask()}})};n.fn.smlib_listbuilder_create.smlib_ShareForm_ListItemEmailClick=function(t){for(var i=0;i<this.focuslist.shared.length;i++)if(this.focuslist.shared[i].index==t){this.smlibShowLoadingMask("Send email...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.emailsharedemailservice,data:'{"listid": "'+this.focuslist.id+'", "email": "'+this.focuslist.shared[i].email+'", "index":"'+this.focuslist.shared[i].index+'", "type":"'+this.focuslist.shared[i].type+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(){try{this.parent.smlibHideLoadingMask()}catch(n){alert("Send Email Fail "+n);this.parent.smlibHideLoadingMask()}},failure:function(n){alert("Send Email Fail "+n);this.parent.smlibHideLoadingMask()}});return}};n.fn.smlib_listbuilder_create.smlib_ShareForm_AddService=function(t,i){var r=new n.fn.smlib_listbuilder_item,u;for(r.listid=this.focuslist.id,r.index=this.focuslist.shared.length+1,r.refid="",r.name="No Name",r.email=t,r.image="",r.type=i,r.msg="",u=0;u<this.focuslist.shared.length;u++)if(this.focuslist.shared[u].email.toUpperCase()==t.toUpperCase()){alert("Email already in the list.");return}this.smlibShowLoadingMask("Add Shared With...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.savesharedemailservice,data:'{"listid": "'+this.focuslist.id+'", "email": "'+r.email+'", "index":"'+r.index+'", "type":"'+r.type+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_ShareForm_AddServiceResult(JSON.parse(n.d))}catch(t){alert("Save Item Fail "+t)}},failure:function(n){alert("Save Item Fail "+n)}})};n.fn.smlib_listbuilder_create.smlib_ShareForm_AddServiceResult=function(n){if(n.msg!="")alert(n.msg);else{for(var t=0;t<this.focuslist.shared.length;t++)if(this.focuslist.shared[t].email.toUpperCase()==n.email.toUpperCase())return;this.focuslist.shared[this.focuslist.shared.length]=n;this.smlib_BuilderList_GetListByID(this.focuslist.id,this.focuslist);this.smlib_ShareForm_LoadList()}this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_ShareForm_DeleteService=function(t){this.smlibShowLoadingMask("Delete Shared...");n.ajax({parent:this,type:"POST",url:this.smlib_listbuilder_create_options.deletesharedemailservice,data:'{"listid": "'+this.focuslist.id+'", "email": "'+t+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){try{this.parent.smlib_ShareForm_DeleteServiceResult(JSON.parse(n.d))}catch(t){alert("Save Item Fail "+t)}},failure:function(n){alert("Save Item Fail "+n)}})};n.fn.smlib_listbuilder_create.smlib_ShareForm_DeleteServiceResult=function(n){var i,t;if(n.msg!="")alert(n.msg);else{for(i=this.focuslist.shared,this.focuslist.shared=[],t=0;t<i.length;t++)i[t].email!=n.email&&(this.focuslist.shared[this.focuslist.shared.length]=i[t]);this.smlib_BuilderList_GetListByID(this.focuslist.id,this.focuslist);this.smlib_ShareForm_LoadList()}this.smlibHideLoadingMask()}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_PatronForm_InnerHTML=function(t,i){var r="";return r+="<div ",r+='id="'+t+'_patronform_headerdiv" ',r+='class="header form"',r+=">",r+='<div class="input-group inputdiv" style="width:100%;">',r+='<span class="input-group-addon" ><input class="smlibpatronformitemcheckallbox" type="checkbox" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PatronForm_CheckAllClick()",t)+'" /><\/span>',r+='<input class="form-control" placeholder="Keywrods in Patron" id="'+t+'_patronform_searchbox" onchange="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PatronForm_SearchClick()",t)+'">',r+='<select style="width:100%;" class="form-control"  id="'+t+'_patronform_typebox" >',r+='<option value="READONLY">Static List<\/option>',r+='<option value="COLLABORATE">Collaborative List<\/option>',r+="<\/select>",r+='<span class="input-group-addon" role="button"  ><i id="'+t+'_patronform_searchbtn" class="fa fa-search fa-fw" style="width:auto;" ><\/i><\/span>',r+='<span class="input-group-addon" role="button"  ><i id="'+t+'_patronform_addbtn" class="fa fa-plus fa-fw" style="width:auto;" onclick="'+n.fn.smlib_listbuilder_create.smlib_AssignParentActions("smlib_PatronForm_AddSelectedClick(0)",t)+'">&nbsp;Add Selected<\/i><\/span>',r+="<\/div>",r+="<\/div>",r+="<div ",r+='id="'+t+'_patronform_contentdiv" ',r+='class="content form" style="top: 80px;height:'+(i.height-150)+"px;min-height:"+(i.height-150)+"px;max-height:"+(i.height-150)+'px"',r+=">",r+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_PatronForm_AssignFunctions=function(t){t.smlib_PatronForm_ShowLoading=n.fn.smlib_listbuilder_create.smlib_PatronForm_ShowLoading;t.smlib_PatronForm_HideLoading=n.fn.smlib_listbuilder_create.smlib_PatronForm_HideLoading;t.smlib_PatronForm_InputFocus=n.fn.smlib_listbuilder_create.smlib_PatronForm_InputFocus;t.smlib_PatronForm_SearchClick=n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchClick;t.smlib_PatronForm_SearchService=n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchService;t.smlib_PatronForm_SearchServiceResult=n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchServiceResult;t.smlib_PatronForm_AddSelectedClick=n.fn.smlib_listbuilder_create.smlib_PatronForm_AddSelectedClick;t.smlib_PatronForm_LoadMoreClick=n.fn.smlib_listbuilder_create.smlib_PatronForm_LoadMoreClick;t.smlib_PatronForm_CheckAllClick=n.fn.smlib_listbuilder_create.smlib_PatronForm_CheckAllClick;n.fn.smlib_listbuilder_create.smlib_PatronForm_AssignControls(t)};n.fn.smlib_listbuilder_create.smlib_PatronForm_AssignControls=function(n){n.patronkeyword="";n.patronpagenumber=1;n.patronresultset=[]};n.fn.smlib_listbuilder_create.smlib_PatronForm_ShowLoading=function(){this.smlibShowLoadingMask("Searching Patron...");n("#"+this.smlibid+"_patronform_searchbtn").removeClass("fa-search");n("#"+this.smlibid+"_patronform_searchbtn").removeClass("fa-fw");n("#"+this.smlibid+"_patronform_searchbtn").addClass("fa-spinner");n("#"+this.smlibid+"_patronform_searchbtn").addClass("fa-spin")};n.fn.smlib_listbuilder_create.smlib_PatronForm_HideLoading=function(){n("#"+this.smlibid+"_patronform_searchbtn").removeClass("fa-spinner");n("#"+this.smlibid+"_patronform_searchbtn").removeClass("fa-spin");n("#"+this.smlibid+"_patronform_searchbtn").addClass("fa-search");n("#"+this.smlibid+"_patronform_searchbtn").addClass("fa-fw");this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_PatronForm_InputFocus=function(){n("#"+this.smlibid+"_patronform_searchbox").focus()};n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchClick=function(){var t=n("#"+this.smlibid+"_patronform_searchbox").val();t==""?alert("Please input a search keyword first."):(this.patronpagenumber=1,this.smlib_PatronForm_SearchService(t,1,!0))};n.fn.smlib_listbuilder_create.smlib_PatronForm_CheckAllClick=function(){var t;if(n(".smlibpatronformitemcheckallbox")[0].checked)for(t=0;t<n(".smlibpatronformitemcheckbox").length;t++)n(".smlibpatronformitemcheckbox")[t].checked=!0;else for(t=0;t<n(".smlibpatronformitemcheckbox").length;t++)n(".smlibpatronformitemcheckbox")[t].checked=!1};n.fn.smlib_listbuilder_create.smlib_PatronForm_AddSelectedClick=function(t){var i,u,r;if(t<n(".smlibpatronformitemcheckbox").length)if(i=n(".smlibpatronformitemcheckbox")[t].getAttribute("email"),i!="")if(n(".smlibpatronformitemcheckbox")[t].checked){for(u=!0,r=0;r<this.focuslist.shared.length;r++)if(this.focuslist.shared[r].email.toUpperCase()==i.toUpperCase()){u=!1;break}u?(this.smlibShowLoadingMask("Add Patron "+i+"..."),n.ajax({parent:this,parentindex:t,type:"POST",url:this.smlib_listbuilder_create_options.savesharedemailservice,data:'{"listid": "'+this.focuslist.id+'", "email": "'+i+'", "index":"'+(this.focuslist.shared.length+1)+'", "type":"'+n("#"+this.smlibid+"_patronform_typebox").val()+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){try{this.parent.focuslist.shared[this.parent.focuslist.shared.length]=JSON.parse(n.d);this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}catch(t){this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}},failure:function(){this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}})):this.smlib_PatronForm_AddSelectedClick(t+1)}else{for(u=!1,r=0;r<this.focuslist.shared.length;r++)if(this.focuslist.shared[r].email.toUpperCase()===i.toUpperCase()){u=!0;break}u?(this.smlibShowLoadingMask("Remove Patron "+i+"..."),n.ajax({parent:this,parentindex:t,type:"POST",url:this.smlib_listbuilder_create_options.deletesharedemailservice,data:'{"listid": "'+this.focuslist.id+'", "email": "'+i+'"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){var i,t;try{for(i=this.parent.focuslist.shared,this.parent.focuslist.shared=[],t=0;t<i.length;t++)i[t].email.toUpperCase()!=JSON.parse(n.d).email.toUpperCase()&&(this.parent.focuslist.shared[this.parent.focuslist.shared.length]=i[t]);this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}catch(r){this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}},failure:function(){this.parent.smlib_PatronForm_AddSelectedClick(this.parentindex+1)}})):this.smlib_PatronForm_AddSelectedClick(t+1)}else this.smlib_PatronForm_AddSelectedClick(t+1);else this.smlib_BuilderList_GetListByID(this.focuslist.id,this.focuslist),this.smlib_ShareForm_LoadList(),this.smlibHideLoadingMask()};n.fn.smlib_listbuilder_create.smlib_PatronForm_LoadMoreClick=function(){this.patronpagenumber++;this.smlib_PatronForm_SearchService(this.patronkeyword,this.patronpagenumber,!0)};n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchService=function(t,i,r){this.smlib_PatronForm_ShowLoading();r==null&&(r=!1);(i==null||i==1)&&(i=1,n("#"+this.smlibid+"_patronform_contentdiv").html(""),this.patronresultset=[]);this.patronkeyword=t;n.ajax({parent:this,loadmore:r,type:"POST",url:this.smlib_listbuilder_create_options.patronsearchservice,data:'{"Keyword": "'+t+'", "Count": '+this.smlib_listbuilder_create_options.maxsearchresult+', "Page": '+i+', "OrderBy": "FULLNAME", "OrderByDirection": "ASC"}',contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(t){try{this.parent.smlib_PatronForm_SearchServiceResult(JSON.parse(t.d),this.loadmore)}catch(i){n("#"+this.parent.smlibid+"_patronform_contentdiv").html("Search patron Fail "+i)}},failure:function(t){n("#"+this.parent.smlibid+"_patronform_contentdiv").html("Search patron Fail "+t)}})};n.fn.smlib_listbuilder_create.smlib_PatronForm_SearchServiceResult=function(t,i){var u,e,f,r;for(this.smlib_PatronForm_HideLoading(),n("#"+this.smlibid+"_patronform_loadmore").remove(),u=0;u<t.item.length;u++){if(r="",r+='<div class="itemdiv">',r+="<h5>",r+="<strong>"+t.item[u].fullname+"<\/strong>",r+="<\/h5>",r+='<div style="width:100%;display:inline-block;">',r+='<div class="cover">',r+=t.item[u].photourl!=""?'<img src="'+t.item[u].photourl+'" alt="No Photo"   style="width:100%;min-width:100%;max-width:100%;"/>':'<img src="'+this.smlib_listbuilder_create_options.webroot+'PatronPic/noImage.jpg" alt="No Photo"   style="width:100%;min-width:100%;max-width:100%;"/>',t.item[u].email=="")r+="<br/><h5>No Email<\/h5>";else{for(e=!1,f=0;f<this.focuslist.shared.length;f++)if(this.focuslist.shared[f].email.toUpperCase()==t.item[u].email.toUpperCase()){e=!0;break}r+=e?'<br/><input class="smlibpatronformitemcheckbox" type="checkbox" checked patronid="'+t.item[u].patronid+'" email="'+t.item[u].email+'"/>':'<br/><input class="smlibpatronformitemcheckbox" type="checkbox" patronid="'+t.item[u].patronid+'" email="'+t.item[u].email+'"/>'}r+="<\/div>";r+='<div class="halfdetil"><h5>';r+=t.item[u].email!=""?t.item[u].email:"No Email";r+="<\/h5><h5>";r+="Classgrade: "+t.item[u].classgrade+"<\/h5><h5>Home Room: "+t.item[u].homeroom;r+="<\/h5><\/div>";r+="<\/div>";r+="<\/div>";this.patronresultset[this.patronresultset.length]=t.item[u];n("#"+this.smlibid+"_patronform_contentdiv").append(r)}i&&(r="",r+='<div id="'+this.smlibid+'_patronform_loadmore"  class="itemdiv" style="margin-left:0px;margin-bottom:10px;text-align:center" onclick="'+this.smlib_AssignParentActions("smlib_PatronForm_LoadMoreClick()")+'">',r+='<h4 role="button" class="btn btn-primary" style="width:80%;">',r+="Load More",r+="<\/h4>",r+="<\/div>",n("#"+this.smlibid+"_patronform_contentdiv").append(r))}}(jQuery),function(n){n.fn.smlib_listbuilder_create.smlib_Content_InnerHTML=function(n,t){var i="";return i+="<div ",i+='id="'+n+'_contentdiv" ',i+='class="smlib_listbuilder_create_contentdiv" style="height:'+(t.height-50)+"px;min-height:"+(t.height-50)+"px;max-height:"+(t.height-50)+'px;"',i+=">",i+"<\/div>"};n.fn.smlib_listbuilder_create.smlib_Content_AssignFunctions=function(t){t.smlib_Content_ShowContent=n.fn.smlib_listbuilder_create.smlib_Content_ShowContent;t.smlib_Content_HideContent=n.fn.smlib_listbuilder_create.smlib_Content_HideContent;t.smlib_Content_LoadContent=n.fn.smlib_listbuilder_create.smlib_Content_LoadContent;n.fn.smlib_listbuilder_create.smlib_Content_AssignControls(t);n.fn.smlib_listbuilder_create.smlib_BuilderList_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_ListForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_ItemList_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_ItemDetail_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_BookForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_FileForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_YouTubeForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_URLForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_PrintForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_ShareForm_AssignFunctions(t);n.fn.smlib_listbuilder_create.smlib_PatronForm_AssignFunctions(t)};n.fn.smlib_listbuilder_create.smlib_Content_AssignControls=function(){};n.fn.smlib_listbuilder_create.smlib_Content_ShowContent=function(){n("#"+this.smlibid+"_contentdiv").hasClass("smlibactive")||n("#"+this.smlibid+"_contentdiv").addClass("smlibactive")};n.fn.smlib_listbuilder_create.smlib_Content_HideContent=function(){n("#"+this.smlibid+"_contentdiv").hasClass("smlibactive")&&(n("#"+this.smlibid+"_contentdiv").html(""),n("#"+this.smlibid+"_contentdiv").removeClass("smlibactive"))};n.fn.smlib_listbuilder_create.smlib_Content_LoadContent=function(t){t==null&&(t="BUILDER_LIST");switch(t.toUpperCase()){case"CATALOGUE_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"&&this.focuslist.type!="COLLABORATE_LIST"){alert("Can only add item to own or collaborative list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_BookForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_BookForm_InputFocus();break;case"FILE_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"&&this.focuslist.type!="COLLABORATE_LIST"){alert("Can only add item to own or collaborative list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_FileForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_FileForm_InputFocus();break;case"YOUTUBE_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"&&this.focuslist.type!="COLLABORATE_LIST"){alert("Can only add item to own or collaborative list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_YouTubeForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_YouTubeForm_InputFocus();break;case"URL_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"&&this.focuslist.type!="COLLABORATE_LIST"){alert("Can only add item to own or collaborative list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_URLForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options,"NEW"));this.smlib_URLForm_LoadBlank();break;case"PATRON_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"){alert("Can only add patron to own list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_PatronForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options,"NEW"));this.smlib_PatronForm_InputFocus();break;case"EDIT_ITEM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"&&this.focuslist.type!="COLLABORATE_LIST"){alert("Can only edit item to own or collaborative list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_URLForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options,"EDIT"));this.smlib_URLForm_LoadItem();break;case"PRINT_FORM":if(this.focuslist.id==""){alert("Please select a list first");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_PrintForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_PrintForm_LoadControls();break;case"SHARE_FROM":if(this.focuslist.id==""){alert("Please select a list first");return}if(this.focuslist.type!="MY_LIST"){alert("Can only share own list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_ShareForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_ShareForm_LoadList();break;case"ITEM_DETAIL":n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_ItemDetail_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_ItemDetail_Load();break;case"ITEM_LIST":n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_ItemList_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_ItemList_Load();break;case"ADD_LIST":n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_ListForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options,"NEW"));this.smlib_ListForm_LoadBlank();break;case"EDIT_LIST":if(this.focuslist.type!="MY_LIST"){alert("Can only share own list.");return}n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_ListForm_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options,"EDIT"));this.smlib_ListForm_LoadList();break;case"BUILDER_LIST":default:n("#"+this.smlibid+"_contentdiv").html(n.fn.smlib_listbuilder_create.smlib_BuilderList_InnerHTML(this.smlibid,this.smlib_listbuilder_create_options));this.smlib_BuilderList_Load()}}}(jQuery);